!function(){var a=function(a,b){return void 0===a[b]},b=function(b,c){return!a(b,c)};if(a(window,"crossfilter")&&b(window,"console")&&b(console,"warn")&&console.warn("Crossfilter is not available so you will only have basic charting functionality. See https://github.com/ScottLogic/insight for how to get started."),a(window,"d3")){var c="Insight depends on d3. You must include d3 in a script tag. See https://github.com/ScottLogic/insight for how to get started.";throw new Error(c)}}();var insight=function(){return{helpers:{},defaultTheme:{}}}();!function(a){a.MarginMeasurer=function(a){function b(){var b=this,c=10;b.seriesLabelDimensions=function(b,d,e,f){var g,h,i,j,k,l=0,m=0,n=0,o=0,p=b.keyAxis,q=b.valueAxis,r=b.dataset(),s=b.keys(),t=b.x,u=b.y,v=p.display(),w=q.display();if(s.forEach(function(c){v&&(g=t===p?t.tickLabelFormat():u.tickLabelFormat(),h=g(c),i=e.measureText(h),m=Math.max(i.width,m)),w&&(k=a.Utils.valueForKey(r,c,b.keyFunction(),b.valueFunction()),g=u===q?u.tickLabelFormat():t.tickLabelFormat(),h=g(k),j=e.measureText(h),l=Math.max(j.width,l))}),s.length){if(v){var x=p.tickPadding()+p.tickSize(),y=f.measureText(p.label()).width,z=x+y+c;m+=z,n=d}if(w){var A=q.tickPadding()+q.tickSize(),B=f.measureText(q.label()).width,C=A+B+c;l=q.display()?l+C:l,o=d}}var D={maxKeyWidth:m,maxKeyHeight:n,maxValueWidth:l,maxValueHeight:o};if("0"!==p.tickLabelRotation()){var E=Math.sin(p.tickLabelRotation()*Math.PI/180),F=Math.cos(p.tickLabelRotation()*Math.PI/180);D.maxKeyWidth=Math.ceil(Math.max(d*E,m*F)),D.maxKeyHeight=Math.ceil(Math.max(d*F,m*E))}if("0"!==q.tickLabelRotation()){var G=Math.sin(q.tickLabelRotation()*Math.PI/180),H=Math.cos(q.tickLabelRotation()*Math.PI/180);D.maxValueWidth=Math.ceil(Math.max(d*G,l*H)),D.maxValueHeight=Math.ceil(Math.max(d*H,l*G))}return D},b.calculateChartMargins=function(c,d,e,f){f=f?f:e;var g={top:0,left:0,bottom:0,right:0},h=a.Utils.getDrawingContext(d,e),i=a.Utils.getDrawingContext(d,f),j=e["line-height"];if(!j)return g;var k=a.Utils.tryParseInt(j.slice(0,j.length-2),16);return c.forEach(function(a){var c=a.keyAxis,d=a.valueAxis,e=b.seriesLabelDimensions(a,k,h,i),f=c.horizontal()?"maxKeyHeight":"maxKeyWidth",j=d.horizontal()?"maxValueHeight":"maxValueWidth";g[c.orientation()]=Math.max(e[f],g[c.orientation()]),g[d.orientation()]=Math.max(e[j],g[d.orientation()])}),g}}return b}(a)}(insight),insight.Constants=function(){var a={};return a.Behind="behind",a.Front="front",a.AxisTextClass="axis-text",a.AxisLabelClass="axis-label",a.YAxisClass="y-axis",a.AxisClass="in-axis",a.XAxisClass="x-axis",a.XAxisRotation="rotate(90)",a.Tooltip="d3-tip",a.ToolTipTextClass="tooltip",a.BarGroupClass="bargroup",a.BarClass="bar",a.LineClass="in-line",a.ContainerClass="incontainer",a.ChartSVG="chartSVG",a.PlotArea="plotArea",a.Legend="legend",a.LegendView="legend-view",a.Bubble="bubble",a.Scatter="scatter",a.TableClass="in-table",a.TableRowClass="in-datarow",a}(),insight.Scales=function(){var a={};return a.Ordinal={name:"ordinal",scale:d3.scale.ordinal},a.Linear={name:"linear",scale:d3.scale.linear},a.Time={name:"time",scale:d3.time.scale},a}(),insight.Formatters=function(a){return{currencyFormatter:function(b){var c=a.format(",.02f");return"Â£"+c(b)},numberFormatter:function(b){var c=a.format(",.f");return c(b)},dateFormatter:function(b){var c=a.time.format("%b %Y");return c(b)},percentageFormatter:function(b){var c=a.format("%");return c(b)},format:function(b,c){var d=a.format(b);return d(c)}}}(d3),insight.Utils=function(){var a={},b=function(a,c,d){if(0===d.length)return 0;var e=d[0],f=e.sortParameter,g=e.order,h=f(a),i=f(c);if(h===i)return b(a,c,d.slice(1));var j=h>i?1:-1;return"ASC"===g?j:-j};return a.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},a.isFunction=function(a){return a instanceof Function},a.highlightSelector=function(){var a=":not(.selected)",b="."+insight.Constants.BarClass+a+",."+insight.Constants.Bubble+a;return b},a.isDate=function(a){return a instanceof Date},a.isNumber=function(a){return"[object Number]"===Object.prototype.toString.call(a)},a.arrayContains=function(a,b){return-1!==a.indexOf(b)},a.addToSet=function(b,c){a.arrayContains(b,c)||b.push(c)},a.keySelector=function(a){var b="";if(a){var c=a.toString();b="in_"+c.replace(/[^A-Z0-9]/gi,"_")}return b},a.takeWhere=function(a,b,c){var d=a.filter(function(a){return a.hasOwnProperty(b)?a[b]===c:!1});return d},a.removeWhere=function(b,c,d){var e=this,f=a.takeWhere(b,c,d);f.forEach(function(a){e.removeItemFromArray(b,a)})},a.removeItemFromArray=function(a,b){var c=a.indexOf(b);c>-1&&a.splice(c,1)},a.arrayUnique=function(a){for(var b=a.concat(),c=0;c<b.length;++c)for(var d=c+1;d<b.length;++d)b[c]===b[d]&&b.splice(d--,1);return b},a.lastElement=function(a){return insight.Utils.isArray(a)&&0!==a.length?a.slice(a.length-1)[0]:void 0},a.objectUnion=function(a,b){var c={},d=null;for(d in b)c[d]=b[d];for(d in a)c[d]=a[d];return c},a.multiSort=function(a,c){if(!c.length)return a;var d=function(a,d){var e=b(a,d,c,0);return e};return a.sort(d)},a.getSVGBoundingBox=function(a){var b=a.ownerSVGElement.createSVGPoint(),c={},d=a.getCTM(),e=a.getBBox(),f=e.width,g=e.height,h=e.x,i=e.y;return b.x=h,b.y=i,c.nw=b.matrixTransform(d),b.x+=f,c.ne=b.matrixTransform(d),b.y+=g,c.se=b.matrixTransform(d),b.x-=f,c.sw=b.matrixTransform(d),b.y-=g/2,c.w=b.matrixTransform(d),b.x+=f,c.e=b.matrixTransform(d),b.x-=f/2,b.y-=g/2,c.n=b.matrixTransform(d),b.y+=g,c.s=b.matrixTransform(d),c},a.valueForKey=function(a,b,c,d){var e=a.filter(function(a){return c(a)===b});return d(e[0])},a.safeString=function(a){return a.split(" ").join("_")},a.tryParseInt=function(a,b){var c=b;return null!=a&&a.length>0&&!isNaN(a)&&(c=parseInt(a)),c},a.getElementStyles=function(a,b){var c=window.getComputedStyle(a),d={};return b.forEach(function(a){try{d[a]=c.getPropertyValue(a)}catch(b){console.log(b)}}),d},a.getDrawingContext=function(a,b){var c=a.getContext("2d");return c.font=b["font-size"]+" "+b["font-family"],c},a}(),function(a){a.ErrorContainer=function(){var b=null,c=null,d=a.ErrorContainer.State.success;this.setError=function(e,f){c=e,b=void 0===f?null:f,d=a.ErrorContainer.State.error},this.setWarning=function(e,f){d!==a.ErrorContainer.State.error&&(c=e,b=void 0===f?null:f,d=a.ErrorContainer.State.warning)},this.data=function(){return b},this.message=function(){return c},this.state=function(){return d}},a.ErrorContainer.State={error:"error",success:"success",warning:"warning"}}(insight),function(a){a.ErrorMessages={invalidArrayParameterException:"Expects array parameter.",invalidDataSetOrArrayParameterException:"Expects insight.DataSet or an object Array parameter.",invalidFunctionParameterException:"Expects function parameter.",nonNumericalPairsException:"Expect all values used to be numeric.At least one invalid pair of values was found, see the data for the details of all invalid pairs.",unequalLengthArraysException:"Expects both arrays to have equal length."}}(insight),insight.helpers.functions=function(){return{createPropertyAccessor:function(a){var b=a.split(".");return function(a){for(var c,d=a,e=0;e<b.length;e++){if(null==d)return void 0;c=b[e],d=d[c]}return d}}}}(),insight.correlation=function(a){function b(b){return b instanceof a.DataSet?b.getData():b}function c(a,b){var c=a.map(function(a,c){var d=b[c];return{x:a,y:d,index:c}});return c}function d(b){var c=a.Utils.isNumber(b.x)&&a.Utils.isNumber(b.y);return c}function e(a){return!d(a)}function f(a){return a.reduce(function(a,b){return a+b})}function g(a){return f(a)/a.length}function h(a,b){for(var c=[],d=0;d<a.length;d++)c.push(a[d]*b[d]);return c}function i(a,b){return a.map(function(a){return a-b})}var j={};return j.fromValues=function(b,j,k){if(k instanceof a.ErrorContainer||(k=new a.ErrorContainer),!a.Utils.isArray(b)||!a.Utils.isArray(j))return void k.setError(a.ErrorMessages.invalidArrayParameterException);if(b.length!==j.length){var l={xLength:b.length,yLength:j.length};return void k.setError(a.ErrorMessages.unequalLengthArraysException,l)}var m=c(b,j),n=m.filter(e),o=m.filter(d),p=o.map(function(a){return a.x}),q=o.map(function(a){return a.y});if(n.length>0&&k.setWarning(a.ErrorMessages.nonNumericalPairsException,n),p.length<2)return p.length;var r=g(p),s=g(q),t=i(p,r),u=i(q,s),v=h(t,t),w=h(u,u),x=h(t,u),y=f(x)/Math.sqrt(f(v)*f(w));return y},j.fromDataSet=function(c,d,e,f){f instanceof a.ErrorContainer||(f=new a.ErrorContainer);var g=b(c);if(!a.Utils.isArray(g))return void f.setError(a.ErrorMessages.invalidDataSetOrArrayParameterException);if(!a.Utils.isFunction(d)||!a.Utils.isFunction(e))return void f.setError(a.ErrorMessages.invalidFunctionParameterException);var h=g.map(d),i=g.map(e),j=a.correlation.fromValues(h,i,f);return j},j}(insight),function(a){a.DataSet=function(a){this.data=a,this.crossfilterData=null,this._orderFunction=function(a,b){return b.value-a.value},this._filterFunction=null},a.DataSet.prototype.initialize=function(){},a.DataSet.prototype.filterFunction=function(a){return arguments.length?(this._filterFunction=a,this):this._filterFunction},a.DataSet.prototype.getData=function(a){var b;return b=this.data.all?this.data.all():this.data,a&&(b=b.sort(a)),this._filterFunction&&(b=b.filter(this._filterFunction)),b},a.DataSet.prototype.orderingFunction=function(a){return arguments.length?(this._orderFunction=a,this):this._orderFunction},a.DataSet.prototype.getOrderedData=function(){var a;return a=this.data.sort(this._orderFunction),this._filterFunction&&(a=a.filter(this._filterFunction)),a},a.DataSet.prototype.group=function(b,c,d){this.crossfilterData=this.crossfilterData||crossfilter(this.data);var e=new a.Dimension(b,this.crossfilterData,c,d),f=new a.Grouping(e);return f}}(insight),function(a){a.Dimension=function(b,c,d,e){this.crossfilterDimension=c.dimension(d),this.name=b,this.filters=[],this.oneToMany=e,this.aggregationFunction=d;var f=this,g=function(b){return function(c){return a.Utils.arrayContains(c,b)}},h=function(a){return function(b){return String(b)===String(a)}};this.createFilterFunction=function(a){var b=f.oneToMany?g(a):h(a);return{name:a,filterFunction:b}}}}(insight),function(a){a.Grouping=function(b){var c,d=[],e=[],f=[],g=[],h=[],i=[],j=!1,k=this,l=null;k.dimension=b;var m=function(){},n=function(a,b){for(var c=b.split("."),d=b,e=null;c.length;)d=c.shift(),e=a,a=a[d];return{container:e,value:a,propertyName:d}},o=function(b){for(var c=0,d=g.length;d>c;c++){var e=g[c],f=b.value[e],h=f.Sum/f.Count;h=a.Utils.isNumber(h)&&isFinite(h)?h:void 0,b.value[e].Average=h}},p=function(a,b){for(var c,d,e=0,g=f.length;g>e;e++){c=f[e],d=n(a.value,c);var h=d.propertyName+"Cumulative";b[h]=b[h]?b[h]+d.value:d.value,d.container[h]=b[h]}return b},q=function(){var b=function(a,b){return a+"_"+b+"_DeviationProduct"},c=function(){return{}},d=function(c){var d=c;return function(c,e){return i.forEach(function(b){if(e.hasOwnProperty(b)){var f=a.Utils.takeWhere(d,"key",k.dimension.aggregationFunction(e))[0].value,g=f[b].Average,h=e[b],i=h-g,j=i*i;c[b]||(c[b]={deviation:[],deviationSquared:[]}),c[b].deviation.push(i),c[b].deviationSquared.push(j)}}),h.forEach(function(d){var e=d[0],f=d[1],g=a.Utils.lastElement(c[e].deviation),h=a.Utils.lastElement(c[f].deviation),i=b(e,f);c[i]||(c[i]=[]),c[i].push(g*h)}),c}},e=function(){return function(){}},f=k.data.all(),g=k.dimension.crossfilterDimension.group().reduce(d(f),e(f),c).all();g.forEach(function(a){var c=function(a){return a.reduce(function(a,b){return a+b})};h.forEach(function(d){var e=d[0],g=d[1],h=b(e,g),i=c(a.value[h]),j=c(a.value[e].deviationSquared),k=c(a.value[g].deviationSquared),l=i/Math.sqrt(j*k),m=f.filter(function(b){return b.key===a.key})[0],n=e+"_Cor_"+g;m.value[n]=l})})},r=function(){var a={},b=k.ordered()?k.getData(k.orderFunction()):k.getData();b.forEach(function(b){o(b),p(b,a)}),h.length>0&&q(),m(k)},s=function(b,c){b.Count++;var f,g,h;for(g=0,h=d.length;h>g;g++)f=d[g],c.hasOwnProperty(f)&&(b[f].Sum+=c[f],b[f].Count++);for(g=0,h=e.length;h>g;g++){f=e[g];var i=b[f];if(c.hasOwnProperty(f)){var j=c[f];if(a.Utils.isArray(j))for(var k in j){var l=j[k];b[f][l]=i.hasOwnProperty(l)?i[l]+1:1,b[f].Total++}else b[f][j]=i.hasOwnProperty(j)?i[j]+1:1,b[f].Total++}}return b},t=function(b,c){b.Count--;var f,g,h;for(g=0,h=d.length;h>g;g++)f=d[g],c.hasOwnProperty(f)&&(b[f].Sum-=c[f],b[f].Count--);for(g=0,h=e.length;h>g;g++)if(f=e[g],c.hasOwnProperty(f)){var i=c[f];if(a.Utils.isArray(i))for(var j in i){var k=i[j];b[f][k]=b[f].hasOwnProperty(k)?b[f][k]-1:0,b[f].Total--}else b[f][i]=b[f].hasOwnProperty(i)?b[f][i]-1:0,b[f].Total--}return b},u=function(){var a,b,c,f={Count:0};for(b=0,c=d.length;c>b;b++)a=d[b],f[a]=f[a]?f[a]:{},f[a].Sum=0,f[a].Count=0;for(b=0,c=e.length;c>b;b++)a=e[b],f[a]=f[a]?f[a]:{},f[a].Total=0;return f},v=function(){function a(a,b){for(e=0,f=g.length;f>e;e++)if(d=g[e],b.hasOwnProperty(d))for(var c in b[d])if("undefined"!=typeof i[b[d][c]]){var j=i[b[d][c]];a.values[j].value++}else i[b[d][c]]=h,a.values[h]={key:b[d][c],value:1},h++;return a}function b(a,b){for(e=0,f=g.length;f>e;e++)if(d=g[e],b.hasOwnProperty(d))for(var c in b[d]){var h=b[d][c],j=i[h];a.values[j].value--}return a}function c(){return{values:[]}}var d,e,f,g=k.count(),h=0,i={},j=k.dimension.crossfilterDimension.groupAll().reduce(a,b,c);return k.orderFunction(function(a,b){return b.value-a.value}),j};k.postAggregation=function(a){return arguments.length?(m=a,k):m},k.sum=function(a){return arguments.length?(d=a,k):d},k.correlationPairs=function(b){if(!arguments.length)return h;h=b;for(var c=0,e=b.length;e>c;c++)a.Utils.addToSet(i,b[c][0]),a.Utils.addToSet(i,b[c][1]);return g=a.Utils.arrayUnique(g.concat(i)),d=a.Utils.arrayUnique(d.concat(i)),k},k.cumulative=function(a){return arguments.length?(f=a,k):f},k.count=function(a){return arguments.length?(e=a,k):e},k.mean=function(b){return arguments.length?(g=b,d=a.Utils.arrayUnique(d.concat(g)),k):g},k.orderFunction=function(a){return arguments.length?(c=a,k):c},k.ordered=function(a){return arguments.length?(j=a,k):j},k.filterFunction=function(a){return arguments.length?(l=a,k):l},k.recalculate=function(){r()},k.initialize=function(){var a;return a=k.dimension.oneToMany?v():k.dimension.crossfilterDimension.group().reduce(s,t,u),k.data=a,r(k),k},k.getData=function(a,b){var c,d=a?a:k.orderFunction();return k.data||k.initialize(),c=k.dimension.oneToMany?k.data.value().values:k.data.all(),c=c.slice(0),d&&(c=c.sort(d)),b&&(c=c.slice(0,b)),l&&(c=c.filter(l)),c}}}(insight),function(a){a.Theme=function(){this.axisStyle={gridlineWidth:void 0,gridlineColor:void 0,showGridlines:void 0,tickSize:void 0,tickPadding:void 0,axisLineWidth:void 0,axisLineColor:void 0,tickLabelFont:void 0,tickLabelColor:void 0,axisLabelFont:void 0,axisLabelColor:void 0},this.chartStyle={seriesPalette:void 0,fillColor:void 0,titleFont:void 0,titleColor:void 0},this.seriesStyle={showPoints:void 0,lineStyle:void 0},this.tableStyle={}}}(insight),function(a){a.LightTheme=function(){a.Theme.apply(this),this.axisStyle.gridlineWidth=1,this.axisStyle.gridlineColor="#888",this.axisStyle.showGridlines=!1,this.axisStyle.tickSize=1,this.axisStyle.tickPadding=10,this.axisStyle.axislineWidth=1,this.axisStyle.axisLineColor="#777",this.axisStyle.tickLabelFont="Helvetica Neue 11pt",this.axisStyle.tickLabelColor="#777",this.axisStyle.axisLabelFont="Helvetica Neue 12pt",this.axisStyle.axisLabelColor="#777",this.chartStyle.seriesPalette=["#3182bd","#c6dbed","#6baed6","#08519c","#9ecae1"],this.chartStyle.fillColor="#fff",this.chartStyle.titleFont="Helvetica Neue 16pt",this.chartStyle.titleColor="#000",this.seriesStyle.showPoints=!1,this.seriesStyle.lineStyle="linear"},a.LightTheme.prototype=Object.create(a.Theme.prototype),a.LightTheme.prototype.constructor=a.LightTheme,a.defaultTheme=new a.LightTheme}(insight),function(a){a.ChartGroup=function(){this.charts=[],this.tables=[],this.groupings=[],this.dimensions=[],this.filteredDimensions=[],this.dimensionListenerMap={};var b=this,c=function(a,c){var d=b.dimensionListenerMap[a];null!=d&&d.forEach(function(a){a.highlight(c)})},d=function(a){a.series().forEach(function(c){i(c.data,a),c.clickEvent=b.chartFilterHandler,f(c.data)})},e=function(a,b){d(a,b)},f=function(c){var d=c.dimension;d&&(a.Utils.addToSet(b.groupings,c),a.Utils.addToSet(b.dimensions,c.dimension))},g=function(a){return a.clickEvent=b.chartFilterHandler,i(a.data,a),b.tables.push(a),a},h=function(a){return a.seriesChanged=e,d(a),b.charts.push(a),a},i=function(c,d){var e=c?c.dimension:null;if(e){var f=b.dimensionListenerMap[e.name];if(f){var g=a.Utils.arrayContains(f,d);g||b.dimensionListenerMap[e.name].push(d)}else b.dimensionListenerMap[e.name]=[d]}};this.add=function(c){return c instanceof a.Chart?h(c):c instanceof a.Table&&g(c),b},this.draw=function(){b.charts.forEach(function(a){a.draw()}),b.tables.forEach(function(a){a.draw()})},this.chartFilterHandler=function(d,e){var f=a.Utils.keySelector(e);c(d.dimension.name,f);var g=d.dimension,h=g.createFilterFunction(e),i="name",j=a.Utils.takeWhere(b.dimensions,i,g.name),k=a.Utils.takeWhere(b.filteredDimensions,i,g.name);k.length||b.filteredDimensions.push(g),j.map(function(c){var d=a.Utils.takeWhere(c.filters,i,h.name).length;d?a.Utils.removeWhere(c.filters,i,h.name):c.filters.push(h),0===c.filters.length?(a.Utils.removeItemFromArray(b.filteredDimensions,c),c.crossfilterDimension.filterAll()):c.crossfilterDimension.filter(function(a){var b=c.filters.map(function(b){return b.filterFunction(a)}),d=b.filter(function(a){return a}).length>0;return d})}),b.groupings.forEach(function(a){a.recalculate()}),b.draw()},this.applyTheme(a.defaultTheme)},a.ChartGroup.prototype.applyTheme=function(a){return this.charts.forEach(function(b){b.applyTheme(a)}),this.tables.forEach(function(b){b.applyTheme(a)}),this}}(insight),function(a){a.Chart=function(b,c){this.name=b,this.element=c,this.selectedItems=[],this.container=null,this.chart=null,this.measureCanvas=document.createElement("canvas"),this.marginMeasurer=new a.MarginMeasurer,this.seriesPalette=[];var d={top:0,left:0,right:0,bottom:0};this.legendView=null;var e=d3.functor(300),f=d3.functor(300),g=d3.functor(300),h=d3.functor(300),i=!1,j=[],k=[],l=[],m=this,n="",o=!0,p=null,q=!1,r=!1,s=null,t=a.Utils.highlightSelector(),u=function(){var a=50,b=m.container[0][0].offsetLeft,c=window.innerWidth-b-a;m.resizeWidth(c)},v=function(b,c){r=!0,window.addEventListener("resize",u),m.container=b?d3.select(c).append("div"):d3.select(m.element).append("div"),m.container.attr("class",a.Constants.ContainerClass).style("position","relative").style("display","inline-block"),m.chartSVG=m.container.append("svg").attr("class",a.Constants.ChartSVG),m.plotArea=m.chartSVG.append("g").attr("class",a.Constants.PlotArea),m.axisMeasurer=m.plotArea.append("text").attr("class",a.Constants.AxisTextClass),m.labelMeasurer=m.container.append("text").attr("class",a.Constants.AxisLabelClass),m.addClipPath()},w=function(){m.zoom=d3.behavior.zoom().on("zoom",m.dragging.bind(m)),m.zoom.x(s.scale),m.zoomExists()||m.plotArea.insert("rect",":first-child").attr("class","zoompane").attr("width",m.width()).attr("height",m.height()-m.margin().top-m.margin().bottom).style("fill","none").style("pointer-events","all"),m.plotArea.select(".zoompane").call(m.zoom),q=!0};this.seriesChanged=function(){},this.draw=function(a){r||v(),this.resizeChart();var b=k.concat(l);b.map(function(b){b.draw(m,a)}),this.series().forEach(function(b,c){b.color=d3.functor(m.seriesPalette[c%m.seriesPalette.length]),b.draw(m,a)}),null!==p&&p.draw(m,m.series()),i&&!q&&w()},this.addClipPath=function(){this.plotArea.append("clipPath").attr("id",this.clipPath()).append("rect").attr("x",1).attr("y",0).attr("width",this.width()-this.margin().left-this.margin().right).attr("height",this.height()-this.margin().top-this.margin().bottom)},this.resizeWidth=function(a){function b(a){c.width(a,!0),c.draw()}var c=this;this.width()>a&&this.width()!==this.minWidth()?b(Math.max(this.minWidth(),a)):this.width()<a&&this.width()!==this.maxWidth()&&b(Math.min(this.maxWidth(),a))},this.resizeChart=function(){if(o){var b=a.Utils.getElementStyles(m.axisMeasurer.node(),["font-size","line-height","font-family"]),c=a.Utils.getElementStyles(m.labelMeasurer.node(),["font-size","line-height","font-family"]);m.calculateLabelMargin(m.marginMeasurer,b,c)}{var d=m.margin();m.measureCanvas.getContext("2d")}m.container.style("width",m.width()+"px"),m.chartSVG.attr("width",m.width()).attr("height",m.height()),m.plotArea=this.plotArea.attr("transform","translate("+d.left+","+d.top+")"),m.plotArea.select("#"+m.clipPath()).append("rect").attr("x",1).attr("y",0).attr("width",m.width()-d.left-d.right).attr("height",m.height()-d.top-d.bottom)},this.zoomable=function(a){return i=!0,s=a,a.zoomable(!0),this},this.zoomExists=function(){var a=this.plotArea.selectAll(".zoompane");return a[0].length},this.dragging=function(){m.draw(!0)},this.margin=function(a){return arguments.length?(o=!1,d=a,this):d},this.clipPath=function(){return a.Utils.safeString(this.name)+"clip"},this.title=function(a){return arguments.length?(n=a,this):n},this.width=function(a,b){return arguments.length?(b||this.maxWidth(a),f=d3.functor(a),this):f()},this.height=function(a){return arguments.length?(e=d3.functor(a),this):e()},this.maxWidth=function(a){return arguments.length?(g=d3.functor(a),this):g()},this.minWidth=function(a){return arguments.length?(h=d3.functor(a),this):h()},this.series=function(a){return arguments.length?(j=a,m.seriesChanged(m,a),this):j},this.legend=function(a){return arguments.length?(p=a,this):p},this.addXAxis=function(a){return a.direction="h",k.push(a),this},this.xAxes=function(a){if(!arguments.length)return k;k=[];for(var b=0;b<a.length;b++)m.addXAxis(a[b]);return this},this.xAxis=function(a){if(!arguments.length)return k[0];var b=k.slice(0);return b[0]=a,this.xAxes(b)},this.addYAxis=function(a){return a.direction="v",l.push(a),this},this.yAxes=function(a){if(!arguments.length)return l;l=[];for(var b=0;b<a.length;b++)m.addYAxis(a[b]);return this},this.yAxis=function(a){if(!arguments.length)return l[0];var b=l.slice(0);return b[0]=a,this.yAxes(b)},this.autoMargin=function(a){return arguments.length?(o=a,this):o},this.highlight=function(b){var c=m.plotArea.selectAll("."+b),d=a.Utils.arrayContains(m.selectedItems,b);d?(c.classed("selected",!1),a.Utils.removeItemFromArray(m.selectedItems,b)):(c.classed("selected",!0).classed("notselected",!1),m.selectedItems.push(b));var e=m.plotArea.selectAll(".selected"),f=m.plotArea.selectAll(t);f.classed("notselected",e[0].length>0)},this.applyTheme(a.defaultTheme)},a.Chart.prototype.calculateLabelMargin=function(a,b,c){c=c?c:b;var d=a.calculateChartMargins(this.series(),this.measureCanvas,b,c);this.margin(d)},a.Chart.prototype.applyTheme=function(a){var b=this.xAxes().concat(this.yAxes());return b.forEach(function(b){b.applyTheme(a)}),this.seriesPalette=a.chartStyle.seriesPalette,this.series().forEach(function(b){b.applyTheme(a)}),this}}(insight),function(a){a.Table=function(b,c,d){this.name=b,this.element=c,this.data=d,this.selectedItems=[];var e,f=this,g=[],h=!1,i=[],j=null,k=function(a){return a.label},l=function(a){return a.key},m=function(a){return a.value},n=function(a){return f.columns().map(function(b){return{column:b,value:b.value(a)}})},o=function(){f.tableElement=d3.select(f.element).append("table").attr("class",a.Constants.TableClass),e=f.tableElement.append("thead").append("tr"),e.append("th").attr("class","blank").html(""),f.tableBody=f.tableElement.append("tbody"),h=!0},p=function(b){return a.Constants.TableRowClass+" "+a.Utils.keySelector(l(b))},q=function(a){f.clickEvent(f.data,l(a))},r=function(a,b){var c={sortParameter:a,order:b};i.push(c)};this.columns=function(a){return arguments.length?(g=a,this):g},this.keyFunction=function(a){return arguments.length?(l=a,this):l},this.ascending=function(a){return r(a,"ASC"),this},this.descending=function(a){return r(a,"DESC"),this},this.top=function(a){return arguments.length?(j=a,this):j},this.dataset=function(){var b=i,c=f.data.getData();return c=a.Utils.multiSort(c,b),this.top()&&(c=c.slice(0,this.top())),c},this.highlight=function(b){var c=f.tableBody.selectAll("."+b),d=c.classed("selected");d?(c.classed("selected",!1),a.Utils.removeItemFromArray(f.selectedItems,b)):(c.classed("selected",!0).classed("notselected",!1),f.selectedItems.push(b));var e=this.tableBody.selectAll(".selected"),g=this.tableBody.selectAll("tr:not(.selected)");g.classed("notselected",e[0].length>0)},this.draw=function(){var b=this.dataset(),c=this.columns();h||o(),e.selectAll("th.column").data(c).enter().append("th").attr("class","column").html(k);var d=this.tableBody.selectAll("tr."+a.Constants.TableRowClass).data(b,l);d.enter().append("tr").attr("class",p).on("click",q).append("th").html(l);var f=d.selectAll("td").data(n);f.enter().append("td").html(m),f.exit().remove(),d.exit().remove()},this.applyTheme(a.defaultTheme)},a.Table.prototype.clickEvent=function(){},a.Table.prototype.applyTheme=function(){return this}}(insight),function(a){a.Tooltip=function(){function b(){var a=d3.select(g.container()).append("div");a.attr("class",f).style(g.styles()),g.element=a.node()}function c(a){d3.select(g.element).html(a)}function d(b){var c=a.Utils.getSVGBoundingBox(b),d=g.offset(),e=c.n.y-g.element.offsetHeight,f=c.n.x-g.element.offsetWidth/2;return e+=d.y,f+=d.x,{x:f,y:e}}function e(a){d3.select(g.element).style({opacity:"1",top:a.y+"px",left:a.x+"px"})}var f=a.Constants.Tooltip,g=this,h=null,i={},j={x:0,y:0},k={position:"absolute",opacity:"0",top:"0","pointer-events":"none","box-sizing":"border-box"};this.offset=function(a){return arguments.length?(j=a,this):j},this.styles=function(b){return arguments.length?(i=b,this):a.Utils.objectUnion(k,i)},this.container=function(a){return arguments.length?(h=a,this):h},this.show=function(a,f){this.element||b(),c(f);var g=d(a);e(g)},this.hide=function(){d3.select(g.element).style("opacity","0")}}}(insight),function(a){a.Legend=function(){var b=!1,c=function(a,b){return 20*b+5},d=function(a){return a.color()},e=function(a,b){return 20*b+14},f=function(a){return a.name};this.init=function(c){b=!0,null!==c.legendView&&(c.legendView.removeChild(c.legendBox),c.legendView.removeChild(c.legendItems),c.chartSVG.removeChild(c.legendView)),c.legendView=c.chartSVG.append("g").attr("class",a.Constants.LegendView).attr("transform","translate("+(c.width()-80)+",30)"),c.legendBox=c.legendView.append("rect").style("stroke","black").style("stroke-width",1).style("fill","white"),c.legendItems=c.legendView.append("g").attr("class",a.Constants.Legend)},this.draw=function(a){b||this.init(a);var g=a.series(),h=0,i=0,j=a.measureCanvas.getContext("2d");j.font="12px sans-serif",a.legendItems.selectAll("rect").data(g).enter().append("rect").attr("x",5).attr("y",c).attr("width",10).attr("height",10).style("fill",d),a.legendItems.selectAll("text").data(g).enter().append("text").attr("x",20).attr("y",e).attr("width",function(a){return j.measureText(a.name).width}).attr("height",20).text(f).attr("font-family","sans-serif").attr("font-size","12px").attr("fill","black");for(var k=0;k<g.length;k++){var l=j.measureText(g[k].name).width;h=20*k+20,i=Math.max(i,l+25)}a.legendBox.attr("width",i).attr("height",h),a.legendItems.attr("width",i).attr("height",h)}}}(insight),function(a){a.Axis=function(b,c){this.scaleType=c.name,this.scale=c.scale(),this.rangeType=this.scale.rangeRoundBands?this.scale.rangeRoundBands:this.scale.rangeRound,this.bounds=[0,0],this.series=[],this.direction="",this.gridlines=new a.AxisGridlines(this);var d=this,e=b,f=d3.functor(!1),g=null,h=d3.functor(0),i=d3.functor(0),j=1,k="0",l=d3.functor("lr"),m=!1,n=d3.functor("#000"),o=!0,p=d3.functor(.1),q=!1,r=!1,s=!1,t=function(){return d.horizontal()?r?"top":"bottom":r?"right":"left"},u=function(){var a=d.orientation();return"left"===a||"top"===a?"end":"start"},v=function(a){return a},w=function(a){var b=d.horizontal()?[0,d.bounds[0]]:[d.bounds[1],0];a.apply(this,[b,d.barPadding()])};this.barPadding=function(a){return arguments.length?(p=d3.functor(a),this):p()};var x=function(){var b=[];return d.series.map(function(a){b=b.concat(a.keys(d.orderingFunction()))}),b=a.Utils.arrayUnique(b)},y=function(){var a=Number.MAX_VALUE;return d.series.map(function(b){var c=b.findMin(d);a=a>c?c:a}),a},z=function(){var a=0;return d.series.map(function(b){var c=b.findMax(d);a=c>a?c:a}),a};this.horizontal=function(){return"h"===this.direction},this.ordered=function(a){return arguments.length?(f=d3.functor(a),this):f()},this.orderingFunction=function(a){return arguments.length?(g=a,this):g},this.addSeries=function(a){this.series.push(a)},this.domain=function(){var b=[];return this.scaleType===a.Scales.Linear.name?b=[0,z()]:this.scaleType===a.Scales.Ordinal.name?b=x():this.scaleType===a.Scales.Time.name&&(b=[new Date(y()),new Date(z())]),b},this.calculateAxisBounds=function(a){var b=[],c=a.margin();return b[0]=a.width()-c.right-c.left,b[1]=a.height()-c.top-c.bottom,d.bounds=b,d.bounds},this.zoomable=function(a){return arguments.length?(s=a,this):s},this.display=function(a){return arguments.length?(o=a,this):o},this.reversedPosition=function(a){return arguments.length?(r=a,this):r},this.label=function(a){return arguments.length?(e=a,this):e},this.tickLabelFormat=function(a){return arguments.length?(v=a,this):v},this.lineWidth=function(a){return arguments.length?(j=a,this):j},this.color=function(a){return arguments.length?(n=d3.functor(a),this):n},this.orientation=function(a){return arguments.length?(t=d3.functor(a),this):t()},this.tickLabelRotation=function(a){return arguments.length?(k=a,this):k},this.tickSize=function(a){return arguments.length?(h=d3.functor(a),this):h()},this.tickPadding=function(a){return arguments.length?(i=d3.functor(a),this):i()},this.textAnchor=function(a){return arguments.length?(u=d3.functor(a),this):u()},this.tickLabelOrientation=function(a){return arguments.length?("tb"===a?k="90":"lr"===a&&(k="0"),l=d3.functor(a),this):l()},this.tickLabelRotationTransform=function(){var a=d.tickPadding()+2*d.tickSize();a=r&&!d.horizontal()?0-a:a;var b=" rotate("+d.tickLabelRotation()+",0,"+a+")";return b},this.axisPosition=function(){var a="translate(";if(d.horizontal()){var b=0,c="top"===d.orientation()?0:d.bounds[1];a+=b+","+c+")"}else{var e="left"===d.orientation()?0:d.bounds[0];a+=e+",0)"}return a},this.pixelValueForValue=function(a){return d.scale(a)},this.positionLabel=function(){d.horizontal()?this.labelElement.style("left",0).style(d.orientation(),0).style("width","100%").style("text-align","center"):this.labelElement.style(d.orientation(),"0").style("top","35%")},this.showGridlines=function(a){return arguments.length?(m=a,this):m},this.initializeScale=function(){w.call(this.scale.domain(this.domain()),this.rangeType)},this.setupAxisView=function(b){q||(q=!0,this.initializeScale(),this.axis=d3.svg.axis(),this.axisElement=b.plotArea.append("g"),this.axisElement.attr("class",a.Constants.AxisClass).call(this.axis).selectAll("text").attr("class",a.Constants.AxisTextClass),this.labelElement=b.container.append("div").attr("class",a.Constants.AxisLabelClass).style("position","absolute"))},this.draw=function(a,b){if(this.calculateAxisBounds(a),this.zoomable()||this.initializeScale(),this.display()){this.setupAxisView(a);var c=b?0:200;this.axis=d3.svg.axis().scale(this.scale).orient(d.orientation()).tickSize(d.tickSize()).tickPadding(d.tickPadding()).tickFormat(d.tickLabelFormat()),this.axisElement.attr("transform",d.axisPosition()).style("stroke",d.color()).style("stroke-width",d.lineWidth()).style("fill","none").transition().duration(c).call(this.axis),this.axisElement.selectAll("text").attr("transform",d.tickLabelRotationTransform()).style("text-anchor",d.textAnchor()),this.labelElement.text(this.label()),this.positionLabel(),this.showGridlines()&&this.gridlines.drawGridLines(a,this.scale.ticks())}},this.applyTheme(a.defaultTheme)},a.Axis.prototype.applyTheme=function(a){return this.tickSize(a.axisStyle.tickSize),this.tickPadding(a.axisStyle.tickPadding),this.color(a.axisStyle.axisLineColor),this.lineWidth(a.axisStyle.axisLineWidth),this.showGridlines(a.axisStyle.showGridlines),this.gridlines.applyTheme(a),this
}}(insight),function(a){a.AxisGridlines=function(b){this.parentAxis=b;var c="#000",d=0;this.allGridlines=function(a){var b="line."+this.parentAxis.label();return a.plotArea.selectAll(b)},this.lineColor=function(a){return arguments.length?(c=a,this):c},this.lineWidth=function(a){return arguments.length?(d=a,this):d},this.drawGridLines=function(a,b){{var e={"class":this.parentAxis.label(),fill:"none","shape-rendering":"crispEdges",stroke:c,"stroke-width":d};this.parentAxis}this.parentAxis.horizontal()?(e.x1=this.parentAxis.pixelValueForValue,e.x2=this.parentAxis.pixelValueForValue,e.y1=0,e.y2=this.parentAxis.bounds[1]):(e.x1=0,e.x2=this.parentAxis.bounds[0],e.y1=this.parentAxis.pixelValueForValue,e.y2=this.parentAxis.pixelValueForValue);var f=this.allGridlines(a).data(b);f.enter().append("line"),f.attr(e),f.exit().remove()},this.applyTheme(a.defaultTheme)},a.AxisGridlines.prototype.applyTheme=function(a){return this.lineWidth(a.axisStyle.gridlineWidth),this.lineColor(a.axisStyle.gridlineColor),this}}(insight),function(a){a.Series=function(b,c,d,e){this.data=c,this.usesCrossfilter=c instanceof a.DataSet||c instanceof a.Grouping,this.x=d,this.y=e,this.name=b,this.color=d3.functor("lightblue"),this.animationDuration=300,this.topValues=null,this.classValues=[],this.valueAxis=e,this.keyAxis=d,this.selectedItems=[],d.addSeries(this),e.addSeries(this);var f=this,g=null,h={x:0,y:-10},i=function(a){return a.key},j=function(a){return a.key},k=function(a){return a.value},l=function(a){return a},m=function(a){return k(a)},n=function(b,c){var d="";return b.length&&(d=a.Utils.arrayContains(b,c)?" selected":" notselected"),d};this.seriesClassName=function(){var a=[f.name+"class"].concat(f.classValues).join(" ");return a};var o=function(a,b){var c=f.data.slice(0);return a&&(c=c.sort(a)),b&&(c=c.slice(0,top)),c};this.itemClassName=function(b){var c=a.Utils.keySelector(j(b)),d=n(f.selectedItems,c),e=f.seriesClassName()+" "+c+d;return e},this.keyFunction=function(a){return arguments.length?(i=a,this):i},this.groupKeyFunction=function(a){return arguments.length?(j=a,this):j},this.valueFunction=function(a){return arguments.length?(k=a,this):k},this.dataset=function(a){f.keyAxis.ordered()&&!a&&(a=function(a,b){return f.valueFunction()(b)-f.valueFunction()(a)});var b=this.usesCrossfilter?f.data.getData(a,f.topValues):o(a,f.topValues);return g&&(b=b.filter(g)),b},this.keys=function(a){return this.dataset(a).map(f.keyFunction())},this.tooltipOffset=function(a){return arguments.length?(h=a,this):h},this.initializeTooltip=function(b){this.tooltip||(this.tooltip=(new a.Tooltip).container(b).offset(f.tooltipOffset()))},this.mouseOver=function(a,b,c){var d=c||f.tooltipFunction(),e=l(d(a));f.tooltip.show(this,e),d3.select(this).classed("active",!0)},this.mouseOut=function(){f.tooltip.hide(),d3.select(this).classed("active",!1)},this.click=function(a,b){var c=j(b);f.clickEvent(f.data,c)},this.filterFunction=function(a){return arguments.length?(g=a,this):g},this.tooltipFormat=function(a){return arguments.length?(l=a,this):l},this.tooltipFunction=function(a){return arguments.length?(m=a,this):m},this.top=function(a){return arguments.length?(this.topValues=a,this):this.topValues},this.findMin=function(a){var b=this,c=this.dataset(),d=a===b.x?b.keyFunction():b.valueFunction();return d3.min(c,d)},this.findMax=function(a){var b=this,c=this.dataset(),d=a===b.x?b.keyFunction():b.valueFunction();return d3.max(c,d)},this.draw=function(){}},a.Series.prototype.clickEvent=function(){},a.Series.prototype.applyTheme=function(){return this}}(insight),function(a){a.MarkerSeries=function(b,c,d,e){a.Series.call(this,b,c,d,e);var f=this,g=5,h=1,i=0,j=!1,k=!0;return this.xPosition=function(a){var b=0;return k?(b=f.x.scale(f.keyFunction()(a)),i=f.calculateOffset(a),b=1!==h?b+i:b):b=f.x.scale(f.valueFunction()(a)),b},this.keys=function(){var a=f.keyFunction();return f.dataset().map(a)},this.calculateOffset=function(a){var b=j?f.markerHeight(a):f.markerWidth(a),c=j?f.y.scale.rangeBand(a):f.x.scale.rangeBand(a);return.5*(c-b)},this.yPosition=function(a){var b=0;return j?(b=f.y.scale(f.keyFunction()(a)),i=f.calculateOffset(a),b=1!==h?b+i:b):b=f.y.scale(f.valueFunction()(a)),b},this.horizontal=function(){return j=!0,k=!1,this},this.vertical=function(){return k=!0,j=!1,this},this.widthFactor=function(a){return arguments.length?(h=a,this):h},this.thickness=function(a){return arguments.length?(g=a,this):g},this.markerWidth=function(a){var b=0;return b=j?f.thickness():f.x.scale.rangeBand(a)*h},this.markerHeight=function(a){var b=0;return b=j?f.y.scale.rangeBand(a)*h:f.thickness()},this.draw=function(b){f.initializeTooltip(b.container.node()),f.selectedItems=b.selectedItems;var c=function(a){a.yPos=0,a.xPos=0},d=(this.dataset().forEach(c),b.plotArea.selectAll("g."+a.Constants.BarGroupClass+"."+this.name).data(this.dataset(),this.keyAccessor)),e=d.enter().append("g").attr("class",a.Constants.BarGroupClass+" "+this.name),g=e.selectAll("rect.bar"),h=function(a){return f.click(this,a)},i=function(a,b){return 200+20*b};g=e.append("rect").attr("class",f.itemClassName).attr("y",this.y.bounds[0]).attr("height",0).attr("fill",this.color).attr("clip-path","url(#"+b.clipPath()+")").on("mouseover",this.mouseOver).on("mouseout",this.mouseOut).on("click",h);var j=d.selectAll("."+this.name+"class");j.transition().duration(i).attr("y",this.yPosition).attr("x",this.xPosition).attr("width",this.markerWidth).attr("height",this.markerHeight),d.exit().remove()},this},a.MarkerSeries.prototype=Object.create(a.Series.prototype),a.MarkerSeries.prototype.constructor=a.MarkerSeries}(insight),function(a){a.BubbleSeries=function(b,c,d,e){a.Series.call(this,b,c,d,e);var f=this,g=(this.name+a.Constants.Bubble,d3.functor(10));this.classValues=[a.Constants.Bubble],this.rangeY=function(a){return f.y.scale(f.valueFunction()(a))},this.rangeX=function(a){return f.x.scale(f.keyFunction()(a))},this.radiusFunction=function(a){return arguments.length?(g=a,this):g},this.findMax=function(a){var b=this,c=this.dataset(),d=a===b.x?b.keyFunction():b.valueFunction();return d3.max(c,d)},this.bubbleData=function(a){var b=d3.max(a,g),c=function(a){return a.radius},d=(a.map(f.keyFunction()),a.map(f.valueFunction()),this.x.bounds[1]),e=this.y.bounds[0],h=Math.min(d/10,e/10);return a.forEach(function(a){var c=g(a);a.radius=0===c?0:c*h/b}),a=a.concat().sort(function(a,b){return d3.descending(c(a),c(b))})},this.draw=function(b,c){this.initializeTooltip(b.container.node()),this.selectedItems=b.selectedItems;var d=c?0:function(a,b){return 200+20*b},e=function(a){return f.click(this,a)},g=this.bubbleData(this.dataset()),h=b.plotArea.selectAll("circle."+a.Constants.Bubble).data(g,f.keyFunction());h.enter().append("circle").attr("class",f.itemClassName).on("mouseover",f.mouseOver).on("mouseout",f.mouseOut).on("click",e);var i=function(a){return a.radius},j=function(){return this.classList&&this.classList.contains("selected")?.8:this.classList&&this.classList.contains("notselected")?.3:.5};h.transition().duration(d).attr("r",i).attr("cx",f.rangeX).attr("cy",f.rangeY).attr("opacity",j).style("fill",this.color)}},a.BubbleSeries.prototype=Object.create(a.Series.prototype),a.BubbleSeries.prototype.constructor=a.BubbleSeries}(insight),function(a){a.ScatterSeries=function(b,c,d,e){a.Series.call(this,b,c,d,e);var f=d3.functor(3),g=d3.functor(1),h=this,i=this.name+a.Constants.Scatter;this.findMax=function(a){var b=this,c=0,d=this.data.getData(),e=a===b.x?b.keyFunction():b.valueFunction(),f=d3.max(d,e);return c=f>c?f:c},this.rangeY=function(a){return h.y.scale(h.valueFunction()(a))},this.rangeX=function(a){return h.x.scale(h.keyFunction()(a))},this.radiusFunction=function(a){return arguments.length?(f=a,this):f},this.pointRadius=function(a){return arguments.length?(f=d3.functor(a),this):f()},this.pointOpacity=function(a){return arguments.length?(g=d3.functor(a),this):g()};var j=function(){return i+" "+a.Constants.Scatter+" "+h.dimensionName};this.scatterData=function(a){d3.max(a,f),a.map(h.keyFunction()),a.map(h.valueFunction()),this.x.bounds[1],this.y.bounds[0];return a.forEach(function(a){a.radius=f(a)}),a},this.draw=function(a,b){h.initializeTooltip(a.container.node()),h.selectedItems=a.selectedItems;var c=function(a){return h.click(this,a)},d=this.scatterData(this.dataset()),e=a.plotArea.selectAll("circle."+i).data(d,h.keyFunction());e.enter().append("circle").attr("class",j).on("mouseover",this.mouseOver).on("mouseout",this.mouseOut).on("click",c),e.attr("r",f).attr("cx",h.rangeX).attr("cy",h.rangeY).attr("opacity",g).attr("fill",this.color)}},a.ScatterSeries.prototype=Object.create(a.Series.prototype),a.ScatterSeries.prototype.constructor=a.ScatterSeries}(insight),function(a){a.RowSeries=function(b,c,d,e){a.Series.call(this,b,c,d,e);var f=this,g=d3.functor(!1),h="",i={};this.valueAxis=d,this.keyAxis=e,this.classValues=[a.Constants.BarClass],this.series=[{name:"default",valueFunction:function(a){return f.valueFunction()(a)},tooltipValue:function(a){return f.tooltipFunction()(a)},color:this.color,label:"Value"}],this.seriesMax=function(a){var b=0,c=0,d=f.stacked();for(var e in f.series){var g=f.series[e],h=g.valueFunction(a);c=d?c+h:h,b=c>b?c:b}return b},this.findMax=function(){var a=d3.max(f.dataset(),f.seriesMax);return a},this.stacked=function(a){return arguments.length?(g=d3.functor(a),this):g()},this.calculateXPos=function(a,b){b.xPos||(b.xPos=0);var c=b.xPos;return b.xPos+=a(b),c},this.yPosition=function(a){return f.y.scale(f.keyFunction()(a))},this.calculateYPos=function(a,b){return b.yPos?b.yPos+=a:b.yPos=f.yPosition(b),b.yPos},this.xPosition=function(a){var b=f.currentSeries.valueFunction,c=f.stacked()?f.x.scale(f.calculateXPos(b,a)):0;return c},this.barThickness=function(a){return f.y.scale.rangeBand(a)},this.groupedbarThickness=function(a){var b=f.barThickness(a),c=f.stacked()||1===f.series.length?b:b/f.series.length;return c},this.offsetYPosition=function(a){var b=f.groupedbarThickness(a),c=f.stacked()?f.yPosition(a):f.calculateYPos(b,a);return c},this.barWidth=function(a){var b=f.currentSeries.valueFunction;return f.x.scale(b(a))};var j=function(a,b){var c=this.getAttribute("in_series"),d=i[c];f.mouseOver.call(this,a,b,d)};return this.seriesSpecificClassName=function(a){var b=" "+f.currentSeries.name+"class",c=f.itemClassName(a),d=c+b;return d},this.draw=function(b){f.initializeTooltip(b.container.node()),f.selectedItems=b.selectedItems;var c=function(a){a.yPos=0,a.xPos=0},d=this.dataset(),e="g."+a.Constants.BarGroupClass+"."+this.name,g=a.Constants.BarGroupClass+" "+this.name,k="rect."+a.Constants.BarGroupClass;d.forEach(c);var l=b.plotArea.selectAll(e).data(d,this.keyvalueFunction),m=l.enter().append("g").attr("class",g),n=m.selectAll(k),o=function(a){return f.click(this,a)},p=function(a,b){return 200+20*b},q=function(){return this.classList&&this.classList.contains("notselected")?.5:1};for(var r in this.series){this.currentSeries=this.series[r],h=this.currentSeries.name,i[h]=this.currentSeries.valueFunction;var s="."+h+"class."+a.Constants.BarClass;n=m.append("rect").attr("class",f.seriesSpecificClassName).attr("height",0).attr("fill",this.currentSeries.color).attr("in_series",h).attr("clip-path","url(#"+b.clipPath()+")").on("mouseover",j).on("mouseout",this.mouseOut).on("click",o);{l.selectAll(s).transition().duration(p).attr("y",this.offsetYPosition).attr("x",this.xPosition).attr("height",this.groupedbarThickness).attr("width",this.barWidth).style("opacity",q)}}l.exit().remove()},this},a.RowSeries.prototype=Object.create(a.Series.prototype),a.RowSeries.prototype.constructor=a.RowSeries}(insight),function(a){a.LineSeries=function(b,c,d,e){a.Series.call(this,b,c,d,e);var f=this,g="linear",h=!0;this.classValues=[a.Constants.LineClass];var i=function(){},j=function(){},k=function(){};this.showPoints=function(a){return arguments.length?(h=a,this):h},this.rangeY=function(a){return f.y.scale(f.valueFunction()(a))},this.rangeX=function(a){var b=0;return b=f.x.scale.rangeBand?f.x.scale(f.keyFunction()(a))+f.x.scale.rangeBand()/2:f.x.scale(f.keyFunction()(a))},this.lineType=function(a){return arguments.length?(g=a,this):g},this.draw=function(b,c){this.initializeTooltip(b.container.node());var d=d3.svg.line().x(f.rangeX).y(f.rangeY).interpolate(g),e=(this.dataset(),this.name+"line "+a.Constants.LineClass),l="."+this.name+"line."+a.Constants.LineClass,m="path"+l,n=b.plotArea.selectAll(m);this.rangeExists(n)||b.plotArea.append("path").attr("class",e).style("stroke",this.color).attr("fill","none").attr("clip-path","url(#"+b.clipPath()+")").on("mouseover",i).on("mouseout",j).on("click",k);var o=c?0:300;if(b.plotArea.selectAll(m).datum(this.dataset(),this.matcher).transition().duration(o).attr("d",d),h){var p=b.plotArea.selectAll("circle").data(this.dataset());p.enter().append("circle").attr("class","target-point").attr("clip-path","url(#"+b.clipPath()+")").attr("cx",f.rangeX).attr("cy",b.height()-b.margin().bottom-b.margin().top).on("mouseover",f.mouseOver).on("mouseout",f.mouseOut)}var q=h?this.color:d3.functor(void 0),r=b.plotArea.selectAll("circle");r.transition().duration(o).attr("cx",f.rangeX).attr("cy",f.rangeY).attr("r",5).style("fill",q).style("stroke-width",0)},this.rangeExists=function(a){return 0===a.length?0:a[0].length},this.applyTheme(a.defaultTheme)},a.LineSeries.prototype=Object.create(a.Series.prototype),a.LineSeries.prototype.constructor=a.LineSeries,a.LineSeries.prototype.applyTheme=function(a){return this.lineType(a.seriesStyle.lineStyle),this.showPoints(a.seriesStyle.showPoints),this}}(insight),function(a){a.ColumnSeries=function(b,c,d,e){a.Series.call(this,b,c,d,e);{var f=this,g=d3.functor(!1),h="",i={};this.x.rangeType}this.classValues=[a.Constants.BarClass],this.series=[{name:"default",valueFunction:function(a){return f.valueFunction()(a)},tooltipValue:function(a){return f.tooltipFunction()(a)},color:this.color,label:"Value"}];this.seriesMax=function(a){var b=0,c=0,d=f.stacked();for(var e in f.series){var g=f.series[e],h=g.valueFunction(a);c=d?c+h:h,b=c>b?c:b}return b},this.findMax=function(){var a=d3.max(f.dataset(),f.seriesMax);return a},this.stacked=function(a){return arguments.length?(g=d3.functor(a),this):g()},this.calculateYPos=function(a,b){return b.yPos||(b.yPos=0),b.yPos+=a(b),b.yPos},this.xPosition=function(a){return f.x.scale(f.keyFunction()(a))},this.calculateXPos=function(a,b){return b.xPos?b.xPos+=a:b.xPos=f.xPosition(b),b.xPos},this.yPosition=function(a){var b=f.currentSeries.valueFunction,c=f.y.scale(f.stacked()?f.calculateYPos(b,a):b(a));return c},this.barWidth=function(a){return f.x.scale.rangeBand(a)},this.groupedBarWidth=function(a){var b=f.barWidth(a),c=f.stacked()||1===f.series.length?b:b/f.series.length;return c},this.offsetXPosition=function(a){var b=f.groupedBarWidth(a),c=f.stacked()?f.xPosition(a):f.calculateXPos(b,a);return c};var j=function(a){return f.click(this,a)},k=function(a,b){return 200+20*b},l=function(a,b){var c=this.getAttribute("in_series"),d=i[c];f.mouseOver.call(this,a,b,d)};return this.seriesSpecificClassName=function(a){var b=" "+f.currentSeries.name+"class",c=f.itemClassName(a),d=c+b;return d},this.draw=function(b){f.initializeTooltip(b.container.node()),f.selectedItems=b.selectedItems;var c="g."+a.Constants.BarGroupClass,d="rect."+a.Constants.BarGroupClass,e=function(a){a.yPos=0,a.xPos=0},g=f.dataset();g.forEach(e);var m=b.plotArea.selectAll(c).data(g,f.keyFunction()),n=m.enter().append("g").attr("class",a.Constants.BarGroupClass),o=n.selectAll(d),p=function(a){var c=f.currentSeries.valueFunction;return b.height()-b.margin().top-b.margin().bottom-f.y.scale(c(a))},q=function(){return this.classList&&this.classList.contains("notselected")?.5:1};for(var r in f.series){f.currentSeries=f.series[r],h=f.currentSeries.name,i[h]=f.currentSeries.valueFunction;var s="."+h+"class."+a.Constants.BarClass;o=n.append("rect").attr("class",f.seriesSpecificClassName).attr("y",f.y.bounds[0]).attr("height",0).attr("in_series",h).attr("fill",f.currentSeries.color).attr("clip-path","url(#"+b.clipPath()+")").on("mouseover",l).on("mouseout",f.mouseOut).on("click",j);var t=m.selectAll(s);t.transition().duration(k).attr("y",f.yPosition).attr("x",f.offsetXPosition).attr("width",f.groupedBarWidth).attr("height",p).style("opacity",q)}m.exit().remove()},this},a.ColumnSeries.prototype=Object.create(a.Series.prototype),a.ColumnSeries.prototype.constructor=a.ColumnSeries}(insight),"function"==typeof define&&define.amd&&define("insight",[],function(){return insight});