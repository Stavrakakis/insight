!function(){function a(a,b){return void 0===a[b]}function b(b,c){return!a(b,c)}if(a(window,"crossfilter")&&b(window,"console")&&b(console,"warn")&&console.warn("Crossfilter is not available so you will only have basic charting functionality. See https://github.com/ScottLogic/insight for how to get started."),a(window,"d3")){var c="Insight depends on d3. You must include d3 in a script tag. See https://github.com/ScottLogic/insight for how to get started.";throw new Error(c)}}();var insight=function(){return{helpers:{},defaultTheme:{}}}();!function(a){a.MarginMeasurer=function(){var b=this,c=10;b.seriesLabelDimensions=function(b,d,e,f){var g,h,i,j,k,l=0,m=0,n=0,o=0,p=b.keyAxis,q=b.valueAxis,r=b.dataset(),s=b.keys(),t=b.x,u=b.y,v=p.display(),w=q.display();if(s.forEach(function(c){v&&(g=t===p?t.tickLabelFormat():u.tickLabelFormat(),h=g(c),i=e.measureText(h),m=Math.max(i.width,m)),w&&(k=a.Utils.valueForKey(r,c,b.keyFunction(),b.valueFunction()),g=u===q?u.tickLabelFormat():t.tickLabelFormat(),h=g(k),j=e.measureText(h),l=Math.max(j.width,l))}),s.length){if(v){var x=p.tickPadding()+p.tickSize(),y=f.measureText(p.label()).width,z=x+y+c;m+=z,n=d}if(w){var A=q.tickPadding()+q.tickSize(),B=f.measureText(q.label()).width,C=A+B+c;l=q.display()?l+C:l,o=d}}var D={maxKeyWidth:m,maxKeyHeight:n,maxValueWidth:l,maxValueHeight:o};if("0"!==p.tickLabelRotation()){var E=Math.sin(p.tickLabelRotation()*Math.PI/180),F=Math.cos(p.tickLabelRotation()*Math.PI/180);D.maxKeyWidth=Math.ceil(Math.max(d*E,m*F)),D.maxKeyHeight=Math.ceil(Math.max(d*F,m*E))}if("0"!==q.tickLabelRotation()){var G=Math.sin(q.tickLabelRotation()*Math.PI/180),H=Math.cos(q.tickLabelRotation()*Math.PI/180);D.maxValueWidth=Math.ceil(Math.max(d*G,l*H)),D.maxValueHeight=Math.ceil(Math.max(d*H,l*G))}return D},b.calculateChartMargins=function(c,d,e,f){f=f?f:e;var g={top:0,left:0,bottom:0,right:0},h=a.Utils.getDrawingContext(d,e),i=a.Utils.getDrawingContext(d,f),j=e["line-height"];if(!j)return g;var k=a.Utils.tryParseInt(j.slice(0,j.length-2),16);return c.forEach(function(a){var c=a.keyAxis,d=a.valueAxis,e=b.seriesLabelDimensions(a,k,h,i),f=c.horizontal()?"maxKeyHeight":"maxKeyWidth",j=d.horizontal()?"maxValueHeight":"maxValueWidth";g[c.orientation()]=Math.max(e[f],g[c.orientation()]),g[d.orientation()]=Math.max(e[j],g[d.orientation()])}),g}}}(insight),insight.Constants=function(){var a={};return a.Behind="behind",a.Front="front",a.AxisTextClass="axis-text",a.AxisLabelClass="axis-label",a.YAxisClass="y-axis",a.AxisClass="in-axis",a.XAxisClass="x-axis",a.XAxisRotation="rotate(90)",a.Tooltip="d3-tip",a.ToolTipTextClass="tooltip",a.BarGroupClass="bargroup",a.BarClass="bar",a.LineClass="in-line",a.ContainerClass="incontainer",a.ChartSVG="chartSVG",a.PlotArea="plotArea",a.Legend="legend",a.LegendView="legend-view",a.Bubble="bubble",a.Scatter="scatter",a.TableClass="in-table",a.TableRowClass="in-datarow",a}(),insight.Scales=function(){var a={};return a.Ordinal={name:"ordinal",scale:d3.scale.ordinal},a.Linear={name:"linear",scale:d3.scale.linear},a.Time={name:"time",scale:d3.time.scale},a}(),insight.Formatters=function(a){return{currencyFormatter:function(b){var c=a.format(",.02f");return"Â£"+c(b)},numberFormatter:function(b){var c=a.format(",.f");return c(b)},dateFormatter:function(b){var c=a.time.format("%b %Y");return c(b)},percentageFormatter:function(b){var c=a.format("%");return c(b)},format:function(b,c){var d=a.format(b);return d(c)}}}(d3),insight.Utils=function(){function a(b,c,d){if(0===d.length)return 0;var e=d[0],f=e.sortParameter,g=e.order,h=f(b),i=f(c);if(h===i)return a(b,c,d.slice(1));var j=h>i?1:-1;return"ASC"===g?j:-j}var b={};return b.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},b.isFunction=function(a){return a instanceof Function},b.highlightSelector=function(){var a=":not(.selected)",b="."+insight.Constants.BarClass+a+",."+insight.Constants.Bubble+a;return b},b.isDate=function(a){return a instanceof Date},b.isNumber=function(a){return"[object Number]"===Object.prototype.toString.call(a)},b.arrayContains=function(a,b){return-1!==a.indexOf(b)},b.addToSet=function(a,c){b.arrayContains(a,c)||a.push(c)},b.keySelector=function(a){var b="";if(a){var c=a.toString();b="in_"+c.replace(/[^A-Z0-9]/gi,"_")}return b},b.takeWhere=function(a,b,c){var d=a.filter(function(a){return a.hasOwnProperty(b)?a[b]===c:!1});return d},b.removeWhere=function(a,c,d){var e=this,f=b.takeWhere(a,c,d);f.forEach(function(b){e.removeItemFromArray(a,b)})},b.removeItemFromArray=function(a,b){var c=a.indexOf(b);c>-1&&a.splice(c,1)},b.arrayUnique=function(a){for(var b=a.concat(),c=0;c<b.length;++c)for(var d=c+1;d<b.length;++d)b[c]===b[d]&&b.splice(d--,1);return b},b.lastElement=function(a){return insight.Utils.isArray(a)&&0!==a.length?a.slice(a.length-1)[0]:void 0},b.objectUnion=function(a,b){var c={},d=null;for(d in b)c[d]=b[d];for(d in a)c[d]=a[d];return c},b.multiSort=function(b,c){function d(b,d){var e=a(b,d,c,0);return e}return c.length?b.sort(d):b},b.getSVGBoundingBox=function(a){var b=a.ownerSVGElement.createSVGPoint(),c={},d=a.getCTM(),e=a.getBBox(),f=e.width,g=e.height,h=e.x,i=e.y;return b.x=h,b.y=i,c.nw=b.matrixTransform(d),b.x+=f,c.ne=b.matrixTransform(d),b.y+=g,c.se=b.matrixTransform(d),b.x-=f,c.sw=b.matrixTransform(d),b.y-=g/2,c.w=b.matrixTransform(d),b.x+=f,c.e=b.matrixTransform(d),b.x-=f/2,b.y-=g/2,c.n=b.matrixTransform(d),b.y+=g,c.s=b.matrixTransform(d),c},b.valueForKey=function(a,b,c,d){var e=a.filter(function(a){return c(a)===b});return d(e[0])},b.safeString=function(a){return a.split(" ").join("_")},b.tryParseInt=function(a,b){var c=b;return null!=a&&a.length>0&&!isNaN(a)&&(c=parseInt(a)),c},b.getElementStyles=function(a,b){var c=window.getComputedStyle(a),d={};return b.forEach(function(a){try{d[a]=c.getPropertyValue(a)}catch(b){console.log(b)}}),d},b.getDrawingContext=function(a,b){var c=a.getContext("2d");return c.font=b["font-size"]+" "+b["font-family"],c},b}(),function(a){a.ErrorContainer=function(){var b=this,c=null,d=null,e=a.ErrorContainer.State.success;b.setError=function(b,f){d=b,c=void 0===f?null:f,e=a.ErrorContainer.State.error},b.setWarning=function(b,f){e!==a.ErrorContainer.State.error&&(d=b,c=void 0===f?null:f,e=a.ErrorContainer.State.warning)},b.data=function(){return c},b.message=function(){return d},b.state=function(){return e}},a.ErrorContainer.State={error:"error",success:"success",warning:"warning"}}(insight),function(a){a.ErrorMessages={invalidArrayParameterException:"Expects array parameter.",invalidDataSetOrArrayParameterException:"Expects insight.DataSet or an object Array parameter.",invalidFunctionParameterException:"Expects function parameter.",nonNumericalPairsException:"Expect all values used to be numeric.At least one invalid pair of values was found, see the data for the details of all invalid pairs.",unequalLengthArraysException:"Expects both arrays to have equal length."}}(insight),insight.helpers.functions=function(){return{createPropertyAccessor:function(a){var b=a.split(".");return function(a){for(var c,d=a,e=0;e<b.length;e++){if(null==d)return void 0;c=b[e],d=d[c]}return d}}}}(),insight.correlation=function(a){function b(b){return b instanceof a.DataSet||b instanceof a.Grouping?b.getData():b}function c(a,b){var c=a.map(function(a,c){var d=b[c];return{x:a,y:d,index:c}});return c}function d(b){var c=a.Utils.isNumber(b.x)&&a.Utils.isNumber(b.y);return c}function e(a){return!d(a)}function f(a){return a.reduce(function(a,b){return a+b})}function g(a){return f(a)/a.length}function h(a,b){for(var c=[],d=0;d<a.length;d++)c.push(a[d]*b[d]);return c}function i(a,b){return a.map(function(a){return a-b})}var j={};return j.fromValues=function(b,j,k){if(k instanceof a.ErrorContainer||(k=new a.ErrorContainer),!a.Utils.isArray(b)||!a.Utils.isArray(j))return void k.setError(a.ErrorMessages.invalidArrayParameterException);if(b.length!==j.length){var l={xLength:b.length,yLength:j.length};return void k.setError(a.ErrorMessages.unequalLengthArraysException,l)}var m=c(b,j),n=m.filter(e),o=m.filter(d),p=o.map(function(a){return a.x}),q=o.map(function(a){return a.y});if(n.length>0&&k.setWarning(a.ErrorMessages.nonNumericalPairsException,n),p.length<2)return p.length;var r=g(p),s=g(q),t=i(p,r),u=i(q,s),v=h(t,t),w=h(u,u),x=h(t,u),y=f(x)/Math.sqrt(f(v)*f(w));return y},j.fromDataSet=function(c,d,e,f){f instanceof a.ErrorContainer||(f=new a.ErrorContainer);var g=b(c);if(!a.Utils.isArray(g))return void f.setError(a.ErrorMessages.invalidDataSetOrArrayParameterException);if(!a.Utils.isFunction(d)||!a.Utils.isFunction(e))return void f.setError(a.ErrorMessages.invalidFunctionParameterException);var h=g.map(d),i=g.map(e),j=a.correlation.fromValues(h,i,f);return j},j}(insight),function(a){a.DataSet=function(b){function c(a,b){return b.value-a.value}function d(){return!0}var e=this;e.data=b,e.crossfilterData=null,e.initialize=function(){},e.filterFunction=function(a){return arguments.length?(d=a,e):d},e.getData=function(a){var b;return b=e.data.all?e.data.all():e.data,a&&(b=b.sort(a)),b=b.filter(d)},e.orderingFunction=function(a){return arguments.length?(c=a,e):c},e.getOrderedData=function(){var a;return a=e.data.filter(d).sort(c)},e.group=function(b,c,d){e.crossfilterData=e.crossfilterData||crossfilter(e.data);var f=new a.Dimension(b,e.crossfilterData,c,d),g=new a.Grouping(f);return g}}}(insight),function(a){a.Dimension=function(b,c,d,e){function f(b){return function(c){return a.Utils.arrayContains(c,b)}}function g(a){return function(b){return String(b)===String(a)}}var h=this;h.crossfilterDimension=c.dimension(d),h.name=b,h.filters=[],h.oneToMany=e,h.aggregationFunction=d,h.createFilterFunction=function(a){var b=h.oneToMany?f(a):g(a);return{name:a,filterFunction:b}}}}(insight),function(a){a.Grouping=function(b){function c(){}function d(a,b){for(var c=b.split("."),d=b,e=null;c.length;)d=c.shift(),e=a,a=a[d];return{container:e,value:a,propertyName:d}}function e(b){for(var c=0,d=r.length;d>c;c++){var e=r[c],f=b.value[e],g=f.Sum/f.Count;g=a.Utils.isNumber(g)&&isFinite(g)?g:void 0,b.value[e].Average=g}}function f(a,b){for(var c,e,f=0,g=q.length;g>f;f++){c=q[f],e=d(a.value,c);var h=e.propertyName+"Cumulative";b[h]=b[h]?b[h]+e.value:e.value,e.container[h]=b[h]}return b}function g(){function b(a,b){return a+"_"+b+"_DeviationProduct"}function c(){return{}}function d(c){var d=c;return function(c,e){return t.forEach(function(b){if(e.hasOwnProperty(b)){var f=a.Utils.takeWhere(d,"key",n.dimension.aggregationFunction(e))[0].value,g=f[b].Average,h=e[b],i=h-g,j=i*i;c[b]||(c[b]={deviation:[],deviationSquared:[]}),c[b].deviation.push(i),c[b].deviationSquared.push(j)}}),s.forEach(function(d){var e=d[0],f=d[1],g=a.Utils.lastElement(c[e].deviation),h=a.Utils.lastElement(c[f].deviation),i=b(e,f);c[i]||(c[i]=[]),c[i].push(g*h)}),c}}function e(){return function(){}}var f=n.data.all(),g=n.dimension.crossfilterDimension.group().reduce(d(f),e(f),c).all();g.forEach(function(a){function c(a){return a.reduce(function(a,b){return a+b})}s.forEach(function(d){var e=d[0],g=d[1],h=b(e,g),i=c(a.value[h]),j=c(a.value[e].deviationSquared),k=c(a.value[g].deviationSquared),l=i/Math.sqrt(j*k),m=f.filter(function(b){return b.key===a.key})[0],n=e+"_Cor_"+g;m.value[n]=l})})}function h(){var a={},b=n.ordered()?n.getData(n.orderFunction()):n.getData();b.forEach(function(b){e(b),f(b,a)}),s.length>0&&g(),c(n)}function i(b,c){b.Count++;var d,e,f;for(e=0,f=o.length;f>e;e++)d=o[e],c.hasOwnProperty(d)&&(b[d].Sum+=c[d],b[d].Count++);for(e=0,f=p.length;f>e;e++){d=p[e];var g=b[d];if(c.hasOwnProperty(d)){var h=c[d];if(a.Utils.isArray(h))for(var i in h){var j=h[i];b[d][j]=g.hasOwnProperty(j)?g[j]+1:1,b[d].Total++}else b[d][h]=g.hasOwnProperty(h)?g[h]+1:1,b[d].Total++}}return b}function j(b,c){b.Count--;var d,e,f;for(e=0,f=o.length;f>e;e++)d=o[e],c.hasOwnProperty(d)&&(b[d].Sum-=c[d],b[d].Count--);for(e=0,f=p.length;f>e;e++)if(d=p[e],c.hasOwnProperty(d)){var g=c[d];if(a.Utils.isArray(g))for(var h in g){var i=g[h];b[d][i]=b[d].hasOwnProperty(i)?b[d][i]-1:0,b[d].Total--}else b[d][g]=b[d].hasOwnProperty(g)?b[d][g]-1:0,b[d].Total--}return b}function k(){var a,b,c,d={Count:0};for(b=0,c=o.length;c>b;b++)a=o[b],d[a]=d[a]?d[a]:{},d[a].Sum=0,d[a].Count=0;for(b=0,c=p.length;c>b;b++)a=p[b],d[a]=d[a]?d[a]:{},d[a].Total=0;return d}function l(){function a(a,b){for(e=0,f=g.length;f>e;e++)if(d=g[e],b.hasOwnProperty(d))for(var c in b[d])if("undefined"!=typeof i[b[d][c]]){var j=i[b[d][c]];a.values[j].value++}else i[b[d][c]]=h,a.values[h]={key:b[d][c],value:1},h++;return a}function b(a,b){for(e=0,f=g.length;f>e;e++)if(d=g[e],b.hasOwnProperty(d))for(var c in b[d]){var h=b[d][c],j=i[h];a.values[j].value--}return a}function c(){return{values:[]}}var d,e,f,g=n.count(),h=0,i={},j=n.dimension.crossfilterDimension.groupAll().reduce(a,b,c);return n.orderFunction(function(a,b){return b.value-a.value}),j}var m,n=this,o=[],p=[],q=[],r=[],s=[],t=[],u=!1,v=null;n.dimension=b,n.postAggregation=function(a){return arguments.length?(c=a,n):c},n.recalculate=function(){h()},n.initialize=function(){var a;return a=n.dimension.oneToMany?l():n.dimension.crossfilterDimension.group().reduce(i,j,k),n.data=a,h(n),n},n.sum=function(a){return arguments.length?(o=a,n):o},n.correlationPairs=function(b){if(!arguments.length)return s;s=b;for(var c=0,d=b.length;d>c;c++)a.Utils.addToSet(t,b[c][0]),a.Utils.addToSet(t,b[c][1]);return r=a.Utils.arrayUnique(r.concat(t)),o=a.Utils.arrayUnique(o.concat(t)),n},n.cumulative=function(a){return arguments.length?(q=a,n):q},n.count=function(a){return arguments.length?(p=a,n):p},n.mean=function(b){return arguments.length?(r=b,o=a.Utils.arrayUnique(o.concat(r)),n):r},n.orderFunction=function(a){return arguments.length?(m=a,n):m},n.ordered=function(a){return arguments.length?(u=a,n):u},n.filterFunction=function(a){return arguments.length?(v=a,n):v},n.getData=function(a,b){var c,d=a?a:n.orderFunction();return n.data||n.initialize(),c=n.dimension.oneToMany?n.data.value().values:n.data.all(),c=c.slice(0),d&&(c=c.sort(d)),b&&(c=c.slice(0,b)),v&&(c=c.filter(v)),c}}}(insight),function(a){a.Theme=function(){var a=this;a.axisStyle={gridlineWidth:void 0,gridlineColor:void 0,showGridlines:void 0,tickSize:void 0,tickPadding:void 0,axisLineWidth:void 0,axisLineColor:void 0,tickLabelFont:void 0,tickLabelColor:void 0,axisLabelFont:void 0,axisLabelColor:void 0},a.chartStyle={seriesPalette:void 0,fillColor:void 0,titleFont:void 0,titleColor:void 0},a.seriesStyle={showPoints:void 0,lineStyle:void 0},a.tableStyle={}}}(insight),function(a){a.LightTheme=function(){var b=this;a.Theme.apply(b),b.axisStyle.gridlineWidth=1,b.axisStyle.gridlineColor="#888",b.axisStyle.showGridlines=!1,b.axisStyle.tickSize=1,b.axisStyle.tickPadding=10,b.axisStyle.axislineWidth=1,b.axisStyle.axisLineColor="#777",b.axisStyle.tickLabelFont="Helvetica Neue 11pt",b.axisStyle.tickLabelColor="#777",b.axisStyle.axisLabelFont="Helvetica Neue 12pt",b.axisStyle.axisLabelColor="#777",b.chartStyle.seriesPalette=["#3182bd","#c6dbed","#6baed6","#08519c","#9ecae1"],b.chartStyle.fillColor="#fff",b.chartStyle.titleFont="Helvetica Neue 16pt",b.chartStyle.titleColor="#000",b.seriesStyle.showPoints=!1,b.seriesStyle.lineStyle="linear"},a.LightTheme.prototype=Object.create(a.Theme.prototype),a.LightTheme.prototype.constructor=a.LightTheme,a.defaultTheme=new a.LightTheme}(insight),function(a){a.ChartGroup=function(){function b(a,b){var c=i.dimensionListenerMap[a];null!=c&&c.forEach(function(a){a.highlight(b)})}function c(a){a.series().forEach(function(b){h(b.data,a),b.clickEvent=i.chartFilterHandler,e(b.data)})}function d(a,b){c(a,b)}function e(b){var c=b.dimension;c&&(a.Utils.addToSet(i.groupings,b),a.Utils.addToSet(i.dimensions,b.dimension))}function f(a){return a.clickEvent=i.chartFilterHandler,h(a.data,a),i.tables.push(a),a}function g(a){return a.seriesChanged=d,c(a),i.charts.push(a),a}function h(b,c){var d=b?b.dimension:null;if(d){var e=i.dimensionListenerMap[d.name];if(e){var f=a.Utils.arrayContains(e,c);f||i.dimensionListenerMap[d.name].push(c)}else i.dimensionListenerMap[d.name]=[c]}}var i=this;i.charts=[],i.tables=[],i.groupings=[],i.dimensions=[],i.filteredDimensions=[],i.dimensionListenerMap={},i.chartFilterHandler=function(c,d){var e=a.Utils.keySelector(d);b(c.dimension.name,e);var f=c.dimension,g=f.createFilterFunction(d),h="name",j=a.Utils.takeWhere(i.dimensions,h,f.name),k=a.Utils.takeWhere(i.filteredDimensions,h,f.name);k.length||i.filteredDimensions.push(f),j.forEach(function(b){var c=a.Utils.takeWhere(b.filters,h,g.name).length;c?a.Utils.removeWhere(b.filters,h,g.name):b.filters.push(g),0===b.filters.length?(a.Utils.removeItemFromArray(i.filteredDimensions,b),b.crossfilterDimension.filterAll()):b.crossfilterDimension.filter(function(a){var c=b.filters.map(function(b){return b.filterFunction(a)}),d=c.filter(function(a){return a}).length>0;return d})}),i.groupings.forEach(function(a){a.recalculate()}),i.draw()},i.draw=function(){i.charts.forEach(function(a){a.draw()}),i.tables.forEach(function(a){a.draw()})},i.add=function(b){return b instanceof a.Chart?g(b):b instanceof a.Table&&f(b),i},i.applyTheme(a.defaultTheme)},a.ChartGroup.prototype.applyTheme=function(a){return this.charts.forEach(function(b){b.applyTheme(a)}),this.tables.forEach(function(b){b.applyTheme(a)}),this}}(insight),function(a){a.Chart=function(b,c){function d(){var a=50,b=g.container[0][0].offsetLeft,c=window.innerWidth-b-a;g.resizeWidth(c)}function e(b,c){t=!0,window.addEventListener("resize",d),g.container=b?d3.select(c).append("div"):d3.select(g.element).append("div"),g.container.attr("class",a.Constants.ContainerClass).style("position","relative").style("display","inline-block"),g.chartSVG=g.container.append("svg").attr("class",a.Constants.ChartSVG),g.plotArea=g.chartSVG.append("g").attr("class",a.Constants.PlotArea),g.axisMeasurer=g.plotArea.append("text").attr("class",a.Constants.AxisTextClass),g.labelMeasurer=g.container.append("text").attr("class",a.Constants.AxisLabelClass),g.addClipPath()}function f(){g.zoom=d3.behavior.zoom().on("zoom",g.dragging.bind(g)),g.zoom.x(u.scale),g.zoomExists()||g.plotArea.insert("rect",":first-child").attr("class","zoompane").attr("width",g.width()).attr("height",g.height()-g.margin().top-g.margin().bottom).style("fill","none").style("pointer-events","all"),g.plotArea.select(".zoompane").call(g.zoom),s=!0}var g=this,h=d3.functor(300),i=d3.functor(300),j=d3.functor(300),k=d3.functor(300),l=!1,m=[],n=[],o=[],p="",q=!0,r=null,s=!1,t=!1,u=null,v=a.Utils.highlightSelector(),w={top:0,left:0,right:0,bottom:0};g.name=b,g.element=c,g.selectedItems=[],g.container=null,g.chart=null,g.measureCanvas=document.createElement("canvas"),g.marginMeasurer=new a.MarginMeasurer,g.seriesPalette=[],g.legendView=null,g.seriesChanged=function(){},g.draw=function(a){t||e(),g.resizeChart();var b=n.concat(o);b.forEach(function(b){b.draw(g,a)}),g.series().forEach(function(b,c){b.color=d3.functor(g.seriesPalette[c%g.seriesPalette.length]),b.draw(g,a)}),null!==r&&r.draw(g,g.series()),l&&!s&&f()},g.addClipPath=function(){g.plotArea.append("clipPath").attr("id",g.clipPath()).append("rect").attr("x",1).attr("y",0).attr("width",g.width()-g.margin().left-g.margin().right).attr("height",g.height()-g.margin().top-g.margin().bottom)},g.resizeWidth=function(a){function b(a){g.width(a,!0),g.draw()}g.width()>a&&g.width()!==g.minWidth()?b(Math.max(g.minWidth(),a)):g.width()<a&&g.width()!==g.maxWidth()&&b(Math.min(g.maxWidth(),a))},g.resizeChart=function(){if(q){var b=a.Utils.getElementStyles(g.axisMeasurer.node(),["font-size","line-height","font-family"]),c=a.Utils.getElementStyles(g.labelMeasurer.node(),["font-size","line-height","font-family"]);g.calculateLabelMargin(g.marginMeasurer,b,c)}{var d=g.margin();g.measureCanvas.getContext("2d")}g.container.style("width",g.width()+"px"),g.chartSVG.attr("width",g.width()).attr("height",g.height()),g.plotArea=g.plotArea.attr("transform","translate("+d.left+","+d.top+")"),g.plotArea.select("#"+g.clipPath()).append("rect").attr("x",1).attr("y",0).attr("width",g.width()-d.left-d.right).attr("height",g.height()-d.top-d.bottom)},g.zoomExists=function(){var a=g.plotArea.selectAll(".zoompane");return a[0].length},g.dragging=function(){g.draw(!0)},g.clipPath=function(){return a.Utils.safeString(g.name)+"clip"},g.highlight=function(b){var c=g.plotArea.selectAll("."+b),d=a.Utils.arrayContains(g.selectedItems,b);d?(c.classed("selected",!1),a.Utils.removeItemFromArray(g.selectedItems,b)):(c.classed("selected",!0).classed("notselected",!1),g.selectedItems.push(b));var e=g.plotArea.selectAll(".selected"),f=g.plotArea.selectAll(v);f.classed("notselected",e[0].length>0)},g.draw=function(a){t||e(),g.resizeChart();var b=n.concat(o);b.forEach(function(b){b.draw(g,a)}),g.series().forEach(function(b,c){b.color=d3.functor(g.seriesPalette[c%g.seriesPalette.length]),b.draw(g,a)}),null!==r&&r.draw(g,g.series()),l&&!s&&f()},g.seriesChanged=function(){},g.zoomable=function(a){return l=!0,u=a,a.zoomable(!0),g},g.margin=function(a){return arguments.length?(q=!1,w=a,g):w},g.title=function(a){return arguments.length?(p=a,g):p},g.width=function(a,b){return arguments.length?(b||g.maxWidth(a),i=d3.functor(a),g):i()},g.height=function(a){return arguments.length?(h=d3.functor(a),g):h()},g.maxWidth=function(a){return arguments.length?(j=d3.functor(a),g):j()},g.minWidth=function(a){return arguments.length?(k=d3.functor(a),g):k()},g.series=function(a){return arguments.length?(m=a,g.seriesChanged(g,a),g):m},g.legend=function(a){return arguments.length?(r=a,g):r},g.addXAxis=function(a){return a.direction="h",n.push(a),g},g.xAxes=function(a){if(!arguments.length)return n;n=[];for(var b=0;b<a.length;b++)g.addXAxis(a[b]);return g},g.xAxis=function(a){if(!arguments.length)return n[0];var b=n.slice(0);return b[0]=a,g.xAxes(b)},g.addYAxis=function(a){return a.direction="v",o.push(a),g},g.yAxes=function(a){if(!arguments.length)return o;o=[];for(var b=0;b<a.length;b++)g.addYAxis(a[b]);return g},g.yAxis=function(a){if(!arguments.length)return o[0];var b=o.slice(0);return b[0]=a,g.yAxes(b)},g.autoMargin=function(a){return arguments.length?(q=a,g):q},g.applyTheme(a.defaultTheme)},a.Chart.prototype.calculateLabelMargin=function(a,b,c){c=c?c:b;var d=a.calculateChartMargins(this.series(),this.measureCanvas,b,c);this.margin(d)},a.Chart.prototype.applyTheme=function(a){var b=this.xAxes().concat(this.yAxes());return b.forEach(function(b){b.applyTheme(a)}),this.seriesPalette=a.chartStyle.seriesPalette,this.series().forEach(function(b){b.applyTheme(a)}),this}}(insight),function(a){a.Table=function(b,c,d){function e(a){return a.label}function f(a){return a.key}function g(a){return a.value}function h(a){return n.columns().map(function(b){return{column:b,value:b.value(a)}})}function i(){n.tableElement=d3.select(n.element).append("table").attr("class",a.Constants.TableClass),m=n.tableElement.append("thead").append("tr"),m.append("th").attr("class","blank").html(""),n.tableBody=n.tableElement.append("tbody"),p=!0}function j(b){return a.Constants.TableRowClass+" "+a.Utils.keySelector(f(b))}function k(a){n.clickEvent(n.data,f(a))}function l(a,b){var c={sortParameter:a,order:b};q.push(c)}var m,n=this,o=[],p=!1,q=[],r=null;n.name=b,n.element=c,n.data=d,n.selectedItems=[],n.highlight=function(b){var c=n.tableBody.selectAll("."+b),d=c.classed("selected");d?(c.classed("selected",!1),a.Utils.removeItemFromArray(n.selectedItems,b)):(c.classed("selected",!0).classed("notselected",!1),n.selectedItems.push(b));var e=n.tableBody.selectAll(".selected"),f=n.tableBody.selectAll("tr:not(.selected)");f.classed("notselected",e[0].length>0)},n.draw=function(){var b=n.dataset(),c=n.columns();p||i(),m.selectAll("th.column").data(c).enter().append("th").attr("class","column").html(e);var d=n.tableBody.selectAll("tr."+a.Constants.TableRowClass).data(b,f);d.enter().append("tr").attr("class",j).on("click",k).append("th").html(f);var l=d.selectAll("td").data(h);l.enter().append("td"),l.html(g),l.exit().remove(),d.exit().remove()},n.columns=function(a){return arguments.length?(o=a,n):o},n.keyFunction=function(a){return arguments.length?(f=a,n):f},n.ascending=function(a){return l(a,"ASC"),n},n.descending=function(a){return l(a,"DESC"),n},n.top=function(a){return arguments.length?(r=a,n):r},n.dataset=function(){var b=q,c=n.data.getData();return c=a.Utils.multiSort(c,b),n.top()&&(c=c.slice(0,n.top())),c},n.applyTheme(a.defaultTheme)},a.Table.prototype.clickEvent=function(){},a.Table.prototype.applyTheme=function(){return this}}(insight),function(a){a.Tooltip=function(){function b(){var a=d3.select(f.container()).append("div");a.attr("class",g).style(f.styles()),f.element=a.node()}function c(a){d3.select(f.element).html(a)}function d(b){var c=a.Utils.getSVGBoundingBox(b),d=f.offset(),e=c.n.y-f.element.offsetHeight,g=c.n.x-f.element.offsetWidth/2;return e+=d.y,g+=d.x,{x:g,y:e}}function e(a){d3.select(f.element).style({opacity:"1",top:a.y+"px",left:a.x+"px"})}var f=this,g=a.Constants.Tooltip,h=null,i={},j={x:0,y:0},k={position:"absolute",opacity:"0",top:"0","pointer-events":"none","box-sizing":"border-box"};f.offset=function(a){return arguments.length?(j=a,f):j},f.styles=function(b){return arguments.length?(i=b,f):a.Utils.objectUnion(k,i)},f.container=function(a){return arguments.length?(h=a,f):h},f.show=function(a,g){f.element||b(),c(g);var h=d(a);e(h)},f.hide=function(){d3.select(f.element).style("opacity","0")}}}(insight),function(a){a.Legend=function(){function b(a,b){return 20*b+5}function c(a){return a.color()}function d(a,b){return 20*b+14}function e(a){return a.name}var f=this,g=!1;f.init=function(b){g=!0,null!==b.legendView&&(b.legendView.removeChild(b.legendBox),b.legendView.removeChild(b.legendItems),b.chartSVG.removeChild(b.legendView)),b.legendView=b.chartSVG.append("g").attr("class",a.Constants.LegendView).attr("transform","translate("+(b.width()-80)+",30)"),b.legendBox=b.legendView.append("rect").style("stroke","black").style("stroke-width",1).style("fill","white"),b.legendItems=b.legendView.append("g").attr("class",a.Constants.Legend)},f.draw=function(a){g||f.init(a);var h=a.series(),i=0,j=0,k=a.measureCanvas.getContext("2d");k.font="12px sans-serif",a.legendItems.selectAll("rect").data(h).enter().append("rect").attr("x",5).attr("y",b).attr("width",10).attr("height",10).style("fill",c),a.legendItems.selectAll("text").data(h).enter().append("text").attr("x",20).attr("y",d).attr("width",function(a){return k.measureText(a.name).width}).attr("height",20).text(e).attr("font-family","sans-serif").attr("font-size","12px").attr("fill","black");for(var l=0;l<h.length;l++){var m=k.measureText(h[l].name).width;i=20*l+20,j=Math.max(j,m+25)}a.legendBox.attr("width",j).attr("height",i),a.legendItems.attr("width",j).attr("height",i)}}}(insight),function(a){a.Axis=function(b,c){function d(){return k.horizontal()?y?"top":"bottom":y?"right":"left"}function e(){var a=k.orientation();return"left"===a||"top"===a?"end":"start"}function f(a){return a}function g(a){var b=k.horizontal()?[0,k.bounds[0]]:[k.bounds[1],0];a.apply(k,[b,k.barPadding()])}function h(){var b=[];return k.series.forEach(function(a){b=b.concat(a.keys(k.orderingFunction()))}),b=a.Utils.arrayUnique(b)}function i(){var a=Number.MAX_VALUE;return k.series.forEach(function(b){var c=b.findMin(k);a=a>c?c:a}),a}function j(){var a=0;return k.series.forEach(function(b){var c=b.findMax(k);a=c>a?c:a}),a}var k=this,l=b,m=d3.functor(!1),n=null,o=d3.functor(0),p=d3.functor(0),q=1,r="0",s=d3.functor("lr"),t=!1,u=d3.functor("#000"),v=!0,w=d3.functor(.1),x=!1,y=!1,z=!1;k.scaleType=c.name,k.scale=c.scale(),k.rangeType=k.scale.rangeRoundBands?k.scale.rangeRoundBands:k.scale.rangeRound,k.bounds=[0,0],k.series=[],k.direction="",k.gridlines=new a.AxisGridlines(k),k.addSeries=function(a){k.series.push(a)},k.domain=function(){var b=[];return k.scaleType===a.Scales.Linear.name?b=[0,j()]:k.scaleType===a.Scales.Ordinal.name?b=h():k.scaleType===a.Scales.Time.name&&(b=[new Date(i()),new Date(j())]),b},k.calculateAxisBounds=function(a){var b=[],c=a.margin();return b[0]=a.width()-c.right-c.left,b[1]=a.height()-c.top-c.bottom,k.bounds=b,k.bounds},k.tickLabelRotationTransform=function(){var a=k.tickPadding()+2*k.tickSize();a=y&&!k.horizontal()?0-a:a;var b=" rotate("+k.tickLabelRotation()+",0,"+a+")";return b},k.axisPosition=function(){var a="translate(";if(k.horizontal()){var b=0,c="top"===k.orientation()?0:k.bounds[1];a+=b+","+c+")"}else{var d="left"===k.orientation()?0:k.bounds[0];a+=d+",0)"}return a},k.pixelValueForValue=function(a){return k.scale(a)},k.positionLabel=function(){k.horizontal()?k.labelElement.style("left",0).style(k.orientation(),0).style("width","100%").style("text-align","center"):k.labelElement.style(k.orientation(),"0").style("top","35%")},k.barPadding=function(a){return arguments.length?(w=d3.functor(a),k):w()},k.initializeScale=function(){g.call(k.scale.domain(k.domain()),k.rangeType)},k.setupAxisView=function(b){x||(x=!0,k.initializeScale(),k.axis=d3.svg.axis(),k.axisElement=b.plotArea.append("g"),k.axisElement.attr("class",a.Constants.AxisClass).call(k.axis).selectAll("text").attr("class",a.Constants.AxisTextClass),k.labelElement=b.container.append("div").attr("class",a.Constants.AxisLabelClass).style("position","absolute"))},k.draw=function(a,b){if(k.calculateAxisBounds(a),k.zoomable()||k.initializeScale(),k.display()){k.setupAxisView(a);var c=b?0:200;k.axis=d3.svg.axis().scale(k.scale).orient(k.orientation()).tickSize(k.tickSize()).tickPadding(k.tickPadding()).tickFormat(k.tickLabelFormat()),k.axisElement.attr("transform",k.axisPosition()).style("stroke",k.color()).style("stroke-width",k.lineWidth()).style("fill","none").transition().duration(c).call(k.axis),k.axisElement.selectAll("text").attr("transform",k.tickLabelRotationTransform()).style("text-anchor",k.textAnchor()),k.labelElement.text(k.label()),k.positionLabel(),k.showGridlines()&&k.gridlines.drawGridLines(a,k.scale.ticks())}},k.horizontal=function(){return"h"===k.direction},k.ordered=function(a){return arguments.length?(m=d3.functor(a),k):m()},k.orderingFunction=function(a){return arguments.length?(n=a,k):n},k.zoomable=function(a){return arguments.length?(z=a,k):z},k.display=function(a){return arguments.length?(v=a,k):v},k.reversedPosition=function(a){return arguments.length?(y=a,k):y},k.label=function(a){return arguments.length?(l=a,k):l},k.tickLabelFormat=function(a){return arguments.length?(f=a,k):f},k.lineWidth=function(a){return arguments.length?(q=a,k):q},k.color=function(a){return arguments.length?(u=d3.functor(a),k):u},k.orientation=function(a){return arguments.length?(d=d3.functor(a),k):d()},k.tickLabelRotation=function(a){return arguments.length?(r=a,k):r},k.tickSize=function(a){return arguments.length?(o=d3.functor(a),k):o()},k.tickPadding=function(a){return arguments.length?(p=d3.functor(a),k):p()},k.textAnchor=function(a){return arguments.length?(e=d3.functor(a),k):e()},k.tickLabelOrientation=function(a){return arguments.length?("tb"===a?r="90":"lr"===a&&(r="0"),s=d3.functor(a),k):s()},k.showGridlines=function(a){return arguments.length?(t=a,k):t},k.applyTheme(a.defaultTheme)},a.Axis.prototype.applyTheme=function(a){return this.tickSize(a.axisStyle.tickSize),this.tickPadding(a.axisStyle.tickPadding),this.color(a.axisStyle.axisLineColor),this.lineWidth(a.axisStyle.axisLineWidth),this.showGridlines(a.axisStyle.showGridlines),this.gridlines.applyTheme(a),this}}(insight),function(a){a.AxisGridlines=function(b){var c=this,d="#000",e=0;c.parentAxis=b,c.drawGridLines=function(a,b){{var f={"class":c.parentAxis.label(),fill:"none","shape-rendering":"crispEdges",stroke:d,"stroke-width":e};c.parentAxis}c.parentAxis.horizontal()?(f.x1=c.parentAxis.pixelValueForValue,f.x2=c.parentAxis.pixelValueForValue,f.y1=0,f.y2=c.parentAxis.bounds[1]):(f.x1=0,f.x2=c.parentAxis.bounds[0],f.y1=c.parentAxis.pixelValueForValue,f.y2=c.parentAxis.pixelValueForValue);var g=c.allGridlines(a).data(b);g.enter().append("line"),g.attr(f),g.exit().remove()},c.allGridlines=function(a){var b="line."+c.parentAxis.label();return a.plotArea.selectAll(b)
},c.lineColor=function(a){return arguments.length?(d=a,c):d},c.lineWidth=function(a){return arguments.length?(e=a,c):e},c.applyTheme(a.defaultTheme)},a.AxisGridlines.prototype.applyTheme=function(a){return this.lineWidth(a.axisStyle.gridlineWidth),this.lineColor(a.axisStyle.gridlineColor),this}}(insight),function(a){a.Series=function(b,c,d,e){function f(a){return a.key}function g(a){return a.key}function h(a){return a.value}function i(a){return a}function j(a){return h(a)}function k(b,c){var d="";return b.length&&(d=a.Utils.arrayContains(b,c)?" selected":" notselected"),d}function l(a,b){var c=m.data.slice(0);return a&&(c=c.sort(a)),b&&(c=c.slice(0,top)),c}var m=this,n=null,o={x:0,y:-10};m.data=c,m.usesCrossfilter=c instanceof a.DataSet||c instanceof a.Grouping,m.x=d,m.y=e,m.name=b,m.color=d3.functor("lightblue"),m.animationDuration=300,m.topValues=null,m.classValues=[],m.valueAxis=e,m.keyAxis=d,m.selectedItems=[],d.addSeries(m),e.addSeries(m),m.seriesClassName=function(){var a=[m.name+"class"].concat(m.classValues).join(" ");return a},m.itemClassName=function(b){var c=a.Utils.keySelector(g(b)),d=k(m.selectedItems,c),e=m.seriesClassName()+" "+c+d;return e},m.keys=function(a){return m.dataset(a).map(m.keyFunction())},m.initializeTooltip=function(b){m.tooltip||(m.tooltip=(new a.Tooltip).container(b).offset(m.tooltipOffset()))},m.mouseOver=function(a,b,c){var d=c||m.tooltipFunction(),e=i(d(a));m.tooltip.show(this,e),d3.select(this).classed("active",!0)},m.mouseOut=function(){m.tooltip.hide(),d3.select(this).classed("active",!1)},m.click=function(a,b){var c=g(b);m.clickEvent(m.data,c)},m.tooltipFunction=function(a){return arguments.length?(j=a,m):j},m.findMin=function(a){var b=m.dataset(),c=a===m.x?m.keyFunction():m.valueFunction();return d3.min(b,c)},m.findMax=function(a){var b=m.dataset(),c=a===m.x?m.keyFunction():m.valueFunction();return d3.max(b,c)},m.draw=function(){},m.keyFunction=function(a){return arguments.length?(f=a,m):f},m.groupKeyFunction=function(a){return arguments.length?(g=a,m):g},m.valueFunction=function(a){return arguments.length?(h=a,m):h},m.dataset=function(a){m.keyAxis.ordered()&&!a&&(a=function(a,b){return m.valueFunction()(b)-m.valueFunction()(a)});var b=m.usesCrossfilter?m.data.getData(a,m.topValues):l(a,m.topValues);return n&&(b=b.filter(n)),b},m.tooltipOffset=function(a){return arguments.length?(o=a,m):o},m.filterFunction=function(a){return arguments.length?(n=a,m):n},m.tooltipFormat=function(a){return arguments.length?(i=a,m):i},m.top=function(a){return arguments.length?(m.topValues=a,m):m.topValues}},a.Series.prototype.clickEvent=function(){},a.Series.prototype.applyTheme=function(){return this}}(insight),function(a){a.MarkerSeries=function(b,c,d,e){a.Series.call(this,b,c,d,e);var f=this,g=5,h=1,i=0,j=!1,k=!0;f.xPosition=function(a){var b=0;return k?(b=f.x.scale(f.keyFunction()(a)),i=f.calculateOffset(a),b=1!==h?b+i:b):b=f.x.scale(f.valueFunction()(a)),b},f.keys=function(){var a=f.keyFunction();return f.dataset().map(a)},f.calculateOffset=function(a){var b=j?f.markerHeight(a):f.markerWidth(a),c=j?f.y.scale.rangeBand(a):f.x.scale.rangeBand(a);return.5*(c-b)},f.yPosition=function(a){var b=0;return j?(b=f.y.scale(f.keyFunction()(a)),i=f.calculateOffset(a),b=1!==h?b+i:b):b=f.y.scale(f.valueFunction()(a)),b},f.horizontal=function(){return j=!0,k=!1,f},f.vertical=function(){return k=!0,j=!1,f},f.markerWidth=function(a){var b=0;return b=j?f.thickness():f.x.scale.rangeBand(a)*h},f.markerHeight=function(a){var b=0;return b=j?f.y.scale.rangeBand(a)*h:f.thickness()},f.draw=function(b){function c(a){a.yPos=0,a.xPos=0}function d(a){return f.click(f,a)}function e(a,b){return 200+20*b}f.initializeTooltip(b.container.node()),f.selectedItems=b.selectedItems;var g=(f.dataset().forEach(c),b.plotArea.selectAll("g."+a.Constants.BarGroupClass+"."+f.name).data(f.dataset(),f.keyAccessor)),h=g.enter().append("g").attr("class",a.Constants.BarGroupClass+" "+f.name),i=h.selectAll("rect.bar");i=h.append("rect").attr("class",f.itemClassName).attr("y",f.y.bounds[0]).attr("height",0).attr("fill",f.color).attr("clip-path","url(#"+b.clipPath()+")").on("mouseover",f.mouseOver).on("mouseout",f.mouseOut).on("click",d);var j=g.selectAll("."+f.name+"class");j.transition().duration(e).attr("y",f.yPosition).attr("x",f.xPosition).attr("width",f.markerWidth).attr("height",f.markerHeight),g.exit().remove()},f.widthFactor=function(a){return arguments.length?(h=a,f):h},f.thickness=function(a){return arguments.length?(g=a,f):g}},a.MarkerSeries.prototype=Object.create(a.Series.prototype),a.MarkerSeries.prototype.constructor=a.MarkerSeries}(insight),function(a){a.BubbleSeries=function(b,c,d,e){a.Series.call(this,b,c,d,e);var f=this,g=(f.name+a.Constants.Bubble,d3.functor(10));f.classValues=[a.Constants.Bubble],f.rangeY=function(a){return f.y.scale(f.valueFunction()(a))},f.rangeX=function(a){return f.x.scale(f.keyFunction()(a))},f.findMax=function(a){var b=f.dataset(),c=a===f.x?f.keyFunction():f.valueFunction();return d3.max(b,c)},f.bubbleData=function(a){function b(a){return a.radius}var c=d3.max(a,g),d=(a.map(f.keyFunction()),a.map(f.valueFunction()),f.x.bounds[1]),e=f.y.bounds[0],h=Math.min(d/10,e/10);return a.forEach(function(a){var b=g(a);a.radius=0===b?0:b*h/c}),a=a.concat().sort(function(a,c){return d3.descending(b(a),b(c))})},f.draw=function(b,c){function d(a){return f.click(f,a)}function e(a){return a.radius}function g(){return this.classList&&this.classList.contains("selected")?.8:this.classList&&this.classList.contains("notselected")?.3:.5}f.initializeTooltip(b.container.node()),f.selectedItems=b.selectedItems;var h=c?0:function(a,b){return 200+20*b},i=f.bubbleData(f.dataset()),j=b.plotArea.selectAll("circle."+a.Constants.Bubble).data(i,f.keyFunction());j.enter().append("circle").attr("class",f.itemClassName).on("mouseover",f.mouseOver).on("mouseout",f.mouseOut).on("click",d),j.transition().duration(h).attr("r",e).attr("cx",f.rangeX).attr("cy",f.rangeY).attr("opacity",g).style("fill",this.color)},f.radiusFunction=function(a){return arguments.length?(g=a,f):g}},a.BubbleSeries.prototype=Object.create(a.Series.prototype),a.BubbleSeries.prototype.constructor=a.BubbleSeries}(insight),function(a){a.ScatterSeries=function(b,c,d,e){function f(){return j+" "+a.Constants.Scatter+" "+i.dimensionName}a.Series.call(this,b,c,d,e);var g=d3.functor(3),h=d3.functor(1),i=this,j=i.name+a.Constants.Scatter;i.findMax=function(a){var b=0,c=i.data.getData(),d=a===i.x?i.keyFunction():i.valueFunction(),e=d3.max(c,d);return b=e>b?e:b},i.rangeY=function(a){return i.y.scale(i.valueFunction()(a))},i.rangeX=function(a){return i.x.scale(i.keyFunction()(a))},i.radiusFunction=function(a){return arguments.length?(g=a,i):g},i.scatterData=function(a){d3.max(a,g),a.map(i.keyFunction()),a.map(i.valueFunction()),i.x.bounds[1],i.y.bounds[0];return a.forEach(function(a){a.radius=g(a)}),a},i.draw=function(a,b){function c(a){return i.click(i,a)}i.initializeTooltip(a.container.node()),i.selectedItems=a.selectedItems;var d=i.scatterData(i.dataset()),e=a.plotArea.selectAll("circle."+j).data(d,i.keyFunction());e.enter().append("circle").attr("class",f).on("mouseover",i.mouseOver).on("mouseout",i.mouseOut).on("click",c),e.attr("r",g).attr("cx",i.rangeX).attr("cy",i.rangeY).attr("opacity",h).style("fill",i.color)},i.pointRadius=function(a){return arguments.length?(g=d3.functor(a),i):g()},i.pointOpacity=function(a){return arguments.length?(h=d3.functor(a),i):h()}},a.ScatterSeries.prototype=Object.create(a.Series.prototype),a.ScatterSeries.prototype.constructor=a.ScatterSeries}(insight),function(a){a.RowSeries=function(b,c,d,e){function f(a,b){var c=this.getAttribute("in_series"),d=j[c];g.mouseOver.call(this,a,b,d)}a.Series.call(this,b,c,d,e);var g=this,h=d3.functor(!1),i="",j={};g.valueAxis=d,g.keyAxis=e,g.classValues=[a.Constants.BarClass],g.series=[{name:"default",valueFunction:function(a){return g.valueFunction()(a)},tooltipValue:function(a){return g.tooltipFunction()(a)},color:g.color,label:"Value"}],g.seriesMax=function(a){var b=0,c=0,d=g.stacked();for(var e in g.series){var f=g.series[e],h=f.valueFunction(a);c=d?c+h:h,b=c>b?c:b}return b},g.findMax=function(){var a=d3.max(g.dataset(),g.seriesMax);return a},g.calculateXPos=function(a,b){b.xPos||(b.xPos=0);var c=b.xPos;return b.xPos+=a(b),c},g.yPosition=function(a){return g.y.scale(g.keyFunction()(a))},g.calculateYPos=function(a,b){return b.yPos?b.yPos+=a:b.yPos=g.yPosition(b),b.yPos},g.xPosition=function(a){var b=g.currentSeries.valueFunction,c=g.stacked()?g.x.scale(g.calculateXPos(b,a)):0;return c},g.barThickness=function(a){return g.y.scale.rangeBand(a)},g.groupedbarThickness=function(a){var b=g.barThickness(a),c=g.stacked()||1===g.series.length?b:b/g.series.length;return c},g.offsetYPosition=function(a){var b=g.groupedbarThickness(a),c=g.stacked()?g.yPosition(a):g.calculateYPos(b,a);return c},g.barWidth=function(a){var b=g.currentSeries.valueFunction;return g.x.scale(b(a))},g.seriesSpecificClassName=function(a){var b=" "+g.currentSeries.name+"class",c=g.itemClassName(a),d=c+b;return d},g.draw=function(b){function c(a){a.yPos=0,a.xPos=0}function d(a){return g.click(g,a)}function e(a,b){return 200+20*b}function h(){return this.classList&&this.classList.contains("notselected")?.5:1}g.initializeTooltip(b.container.node()),g.selectedItems=b.selectedItems;var k=g.dataset(),l="g."+a.Constants.BarGroupClass+"."+g.name,m=a.Constants.BarGroupClass+" "+g.name,n="rect."+a.Constants.BarGroupClass;k.forEach(c);var o=b.plotArea.selectAll(l).data(k),p=o.enter().append("g").attr("class",m),q=p.selectAll(n);for(var r in g.series){g.currentSeries=g.series[r],i=g.currentSeries.name,j[i]=g.currentSeries.valueFunction;var s="."+i+"class."+a.Constants.BarClass;q=p.append("rect").attr("class",g.seriesSpecificClassName).attr("height",0).attr("fill",g.currentSeries.color).attr("in_series",i).attr("clip-path","url(#"+b.clipPath()+")").on("mouseover",f).on("mouseout",g.mouseOut).on("click",d);{o.selectAll(s).transition().duration(e).attr("y",g.offsetYPosition).attr("x",g.xPosition).attr("height",g.groupedbarThickness).attr("width",g.barWidth).style("opacity",h)}}o.exit().remove()},g.stacked=function(a){return arguments.length?(h=d3.functor(a),g):h()}},a.RowSeries.prototype=Object.create(a.Series.prototype),a.RowSeries.prototype.constructor=a.RowSeries}(insight),function(a){a.LineSeries=function(b,c,d,e){function f(){}function g(){}function h(){}a.Series.call(this,b,c,d,e);var i=this,j="linear",k=!0;i.classValues=[a.Constants.LineClass],i.rangeY=function(a){return i.y.scale(i.valueFunction()(a))},i.rangeX=function(a){var b=0;return b=i.x.scale.rangeBand?i.x.scale(i.keyFunction()(a))+i.x.scale.rangeBand()/2:i.x.scale(i.keyFunction()(a))},i.rangeExists=function(a){return 0===a.length?0:a[0].length},i.draw=function(b,c){i.initializeTooltip(b.container.node());var d=d3.svg.line().x(i.rangeX).y(i.rangeY).interpolate(j),e=(i.dataset(),i.name+"line "+a.Constants.LineClass),l="."+i.name+"line."+a.Constants.LineClass,m="path"+l,n=b.plotArea.selectAll(m);i.rangeExists(n)||b.plotArea.append("path").attr("class",e).style("stroke",i.color).attr("fill","none").attr("clip-path","url(#"+b.clipPath()+")").on("mouseover",f).on("mouseout",g).on("click",h);var o=c?0:300;if(b.plotArea.selectAll(m).datum(i.dataset()).transition().duration(o).attr("d",d),k){var p=b.plotArea.selectAll("circle").data(i.dataset());p.enter().append("circle").attr("class","target-point").attr("clip-path","url(#"+b.clipPath()+")").attr("cx",i.rangeX).attr("cy",b.height()-b.margin().bottom-b.margin().top).on("mouseover",i.mouseOver).on("mouseout",i.mouseOut)}var q=k?i.color:d3.functor(void 0),r=b.plotArea.selectAll("circle");r.transition().duration(o).attr("cx",i.rangeX).attr("cy",i.rangeY).attr("r",5).style("fill",q).style("stroke-width",0)},i.showPoints=function(a){return arguments.length?(k=a,i):k},i.lineType=function(a){return arguments.length?(j=a,i):j},i.applyTheme(a.defaultTheme)},a.LineSeries.prototype=Object.create(a.Series.prototype),a.LineSeries.prototype.constructor=a.LineSeries,a.LineSeries.prototype.applyTheme=function(a){return this.lineType(a.seriesStyle.lineStyle),this.showPoints(a.seriesStyle.showPoints),this}}(insight),function(a){a.ColumnSeries=function(b,c,d,e){function f(a){return i.click(i,a)}function g(a,b){return 200+20*b}function h(a,b){var c=this.getAttribute("in_series"),d=l[c];i.mouseOver.call(this,a,b,d)}a.Series.call(this,b,c,d,e);{var i=this,j=d3.functor(!1),k="",l={};i.x.rangeType}i.classValues=[a.Constants.BarClass],i.series=[{name:"default",valueFunction:function(a){return i.valueFunction()(a)},tooltipValue:function(a){return i.tooltipFunction()(a)},color:i.color,label:"Value"}],i.seriesMax=function(a){var b=0,c=0,d=i.stacked();for(var e in i.series){var f=i.series[e],g=f.valueFunction(a);c=d?c+g:g,b=c>b?c:b}return b},i.findMax=function(){var a=d3.max(i.dataset(),i.seriesMax);return a},i.calculateYPos=function(a,b){return b.yPos||(b.yPos=0),b.yPos+=a(b),b.yPos},i.xPosition=function(a){return i.x.scale(i.keyFunction()(a))},i.calculateXPos=function(a,b){return b.xPos?b.xPos+=a:b.xPos=i.xPosition(b),b.xPos},i.yPosition=function(a){var b=i.currentSeries.valueFunction,c=i.y.scale(i.stacked()?i.calculateYPos(b,a):b(a));return c},i.barWidth=function(a){return i.x.scale.rangeBand(a)},i.groupedBarWidth=function(a){var b=i.barWidth(a),c=i.stacked()||1===i.series.length?b:b/i.series.length;return c},i.offsetXPosition=function(a){var b=i.groupedBarWidth(a),c=i.stacked()?i.xPosition(a):i.calculateXPos(b,a);return c},i.seriesSpecificClassName=function(a){var b=" "+i.currentSeries.name+"class",c=i.itemClassName(a),d=c+b;return d},i.draw=function(b){function c(a){a.yPos=0,a.xPos=0}function d(a){var c=i.currentSeries.valueFunction;return b.height()-b.margin().top-b.margin().bottom-i.y.scale(c(a))}function e(){return this.classList&&this.classList.contains("notselected")?.5:1}i.initializeTooltip(b.container.node()),i.selectedItems=b.selectedItems;var j="g."+a.Constants.BarGroupClass,m="rect."+a.Constants.BarGroupClass,n=i.dataset();n.forEach(c);var o=b.plotArea.selectAll(j).data(n,i.keyFunction()),p=o.enter().append("g").attr("class",a.Constants.BarGroupClass),q=p.selectAll(m);for(var r in i.series){i.currentSeries=i.series[r],k=i.currentSeries.name,l[k]=i.currentSeries.valueFunction;var s="."+k+"class."+a.Constants.BarClass;q=p.append("rect").attr("class",i.seriesSpecificClassName).attr("y",i.y.bounds[0]).attr("height",0).attr("in_series",k).attr("fill",i.currentSeries.color).attr("clip-path","url(#"+b.clipPath()+")").on("mouseover",h).on("mouseout",i.mouseOut).on("click",f);var t=o.selectAll(s);t.transition().duration(g).attr("y",i.yPosition).attr("x",i.offsetXPosition).attr("width",i.groupedBarWidth).attr("height",d).style("opacity",e)}o.exit().remove()},i.stacked=function(a){return arguments.length?(j=d3.functor(a),i):j()}},a.ColumnSeries.prototype=Object.create(a.Series.prototype),a.ColumnSeries.prototype.constructor=a.ColumnSeries}(insight),"function"==typeof define&&define.amd&&define("insight",[],function(){return insight});